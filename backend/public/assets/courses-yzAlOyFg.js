import{z as k,E as L,r as x,J as v,K as E,j as e,e as O,w as S,p as i,k as c,T as r,d as j,I as p,B as I,a5 as A}from"./index-FMbyiGBg.js";import{C as F}from"./custom-breadcrumbs-BYE_vmd6.js";import{G as d}from"./Grid-D0Xua7tw.js";import{S as f}from"./Stack-C1li3Gzt.js";const w={title:`My Courses | Student Dashboard - ${O.appName}`};function _(){const u=k(),{authenticated:m,user:s}=L(),[a,B]=x.useState([]),[T,b]=x.useState(!0),y=x.useCallback(async()=>{if(s!=null&&s.UID)try{b(!0);const n=(await v.get(E.courses.list)).data.courses||[],o=[];for(const l of n)try{const D=((await v.get(E.courses.students(l.COURSEID))).data.students||[]).find(U=>U.UID===s.UID);D&&o.push({...l,enrollment:D})}catch(C){console.error(`Error fetching enrollment for course ${l.COURSEID}:`,C)}B(o)}catch(t){console.error("Error fetching enrolled courses:",t)}finally{b(!1)}},[s==null?void 0:s.UID]);if(x.useEffect(()=>{m&&(s!=null&&s.UID)&&y()},[m,s==null?void 0:s.UID,y]),!m)return u.push("/login"),null;const h=t=>{const n=new Date,o=new Date(t.STARTDATE),l=new Date(t.ENDDATE);return o>n?{label:"Upcoming",color:"info"}:o<=n&&l>=n?{label:"Ongoing",color:"success"}:{label:"Completed",color:"default"}},R=t=>{switch(t.STATUS){case"active":return{label:"Active",color:"success"};case"completed":return{label:"Completed",color:"primary"};case"withdrawn":return{label:"Withdrawn",color:"warning"};case"failed":return{label:"Failed",color:"error"};default:return{label:"Unknown",color:"default"}}},g=t=>new Date(t).toLocaleDateString();return T?e.jsxs(e.Fragment,{children:[e.jsx("title",{children:w.title}),e.jsx(S,{maxWidth:"xl",children:e.jsx("div",{children:"Loading your courses..."})})]}):e.jsxs(e.Fragment,{children:[e.jsx("title",{children:w.title}),e.jsxs(S,{maxWidth:"xl",children:[e.jsx(F,{heading:"My Courses",links:[{name:"Dashboard",href:i.dashboard.root},{name:"Student",href:i.dashboard.student.courses},{name:"My Courses"}],sx:{mb:{xs:3,md:5}}}),a.length===0?e.jsxs(c,{sx:{p:4,textAlign:"center"},children:[e.jsx(r,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"You are not enrolled in any courses yet."}),e.jsx(r,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Contact an administrator to enroll you in courses."}),e.jsx(j,{variant:"outlined",startIcon:e.jsx(p,{icon:"eva:arrow-back-fill"}),onClick:()=>u.push(i.dashboard.root),children:"Back to Dashboard"})]}):e.jsxs(d,{container:!0,spacing:3,children:[e.jsx(d,{item:!0,xs:12,md:4,children:e.jsxs(c,{sx:{p:3,textAlign:"center"},children:[e.jsx(r,{variant:"h4",color:"info.main",gutterBottom:!0,children:a.filter(t=>h(t).label==="Upcoming").length}),e.jsx(r,{variant:"h6",gutterBottom:!0,children:"Upcoming Courses"}),e.jsx(r,{variant:"body2",color:"text.secondary",children:"Starting soon"})]})}),e.jsx(d,{item:!0,xs:12,md:4,children:e.jsxs(c,{sx:{p:3,textAlign:"center"},children:[e.jsx(r,{variant:"h4",color:"success.main",gutterBottom:!0,children:a.filter(t=>h(t).label==="Ongoing").length}),e.jsx(r,{variant:"h6",gutterBottom:!0,children:"Ongoing Courses"}),e.jsx(r,{variant:"body2",color:"text.secondary",children:"Currently enrolled"})]})}),e.jsx(d,{item:!0,xs:12,md:4,children:e.jsxs(c,{sx:{p:3,textAlign:"center"},children:[e.jsx(r,{variant:"h4",color:"primary",gutterBottom:!0,children:a.filter(t=>h(t).label==="Completed").length}),e.jsx(r,{variant:"h6",gutterBottom:!0,children:"Completed Courses"}),e.jsx(r,{variant:"body2",color:"text.secondary",children:"Finished courses"})]})}),a.map(t=>{const n=h(t),o=R(t.enrollment);return e.jsx(d,{item:!0,xs:12,md:6,lg:4,children:e.jsx(c,{sx:{p:3,height:"100%"},children:e.jsxs(f,{spacing:2,children:[e.jsxs(I,{children:[e.jsx(r,{variant:"h6",gutterBottom:!0,children:t.TITLE}),e.jsxs(f,{direction:"row",spacing:1,flexWrap:"wrap",useFlexGap:!0,children:[e.jsx(A,{label:n.label,color:n.color,size:"small"}),e.jsx(A,{label:o.label,color:o.color,size:"small"})]})]}),e.jsxs(I,{children:[e.jsxs(r,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:[e.jsx("strong",{children:"Location:"})," ",t.LOCATION]}),e.jsxs(r,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:[e.jsx("strong",{children:"Start Date:"})," ",g(t.STARTDATE)]}),e.jsxs(r,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:[e.jsx("strong",{children:"End Date:"})," ",g(t.ENDDATE)]}),e.jsxs(r,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:[e.jsx("strong",{children:"Enrolled:"})," ",g(t.enrollment.ENROLL_DATE)]}),t.enrollment.FINAL_GRADE&&e.jsxs(r,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:"Grade:"})," ",t.enrollment.FINAL_GRADE,"%"]})]}),e.jsxs(f,{direction:"row",spacing:1,children:[e.jsx(j,{size:"small",variant:"outlined",startIcon:e.jsx(p,{icon:"eva:calendar-fill"}),onClick:()=>u.push(i.dashboard.student.schedule),children:"Schedule"}),e.jsx(j,{size:"small",variant:"outlined",startIcon:e.jsx(p,{icon:"eva:file-text-fill"}),onClick:()=>u.push(i.dashboard.student.grades),children:"Grades"})]})]})})},t.COURSEID)})]})]})]})}export{_ as default};
