import{am as as,r as g,ar as It,as as rs,at as ot,au as is,X as ls,j as o,av as cs,Y as yt,$ as oe,aw as zt,ax as Ht,_ as Dt,a0 as Bt,a1 as us,ay as ds,a5 as Re,a6 as Tt,az as c,aA as we,aB as Ae,aC as Rt,k as Gt,aD as ps,u as fs,h as re,i as ie,p as kt,B as X,T as N,d as Le,V as nt,n as Kt,o as Mt,A as hs}from"./index-BbQvotS-.js";import{A as ms,i as St,u as Yt,a as Qt,o as rt,F as Xt,b as J,C as Jt,T as Zt,d as at,n as es,s as R,e as ts}from"./form-provider-PToGIMDl.js";import{C as gs,t as fe,f as Et,S as ss,a as Nt,D as xs,b as bs}from"./filters-result-DkRmtI61.js";import{G as Ct}from"./Grid-Dk2x3y-O.js";import{S as Ft}from"./Stack-zS2s7YZH.js";function Vt(s){return s.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function Is(s={}){const{ignoreAccents:a=!0,ignoreCase:d=!0,limit:x,matchFrom:k="any",stringify:F,trim:M=!1}=s;return(w,{inputValue:C,getOptionLabel:j})=>{let y=M?C.trim():C;d&&(y=y.toLowerCase()),a&&(y=Vt(y));const U=y?w.filter(G=>{let A=(F||j)(G);return d&&(A=A.toLowerCase()),a&&(A=Vt(A)),k==="start"?A.startsWith(y):A.includes(y)}):w;return typeof x=="number"?U.slice(0,x):U}}const ys=Is(),Wt=5,Ds=s=>{var a;return s.current!==null&&((a=s.current.parentElement)==null?void 0:a.contains(document.activeElement))},Ts=[];function qt(s,a,d,x){if(a||s==null||x)return"";const k=d(s);return typeof k=="string"?k:""}function Ss(s){const{unstable_isActiveElementInListbox:a=Ds,unstable_classNamePrefix:d="Mui",autoComplete:x=!1,autoHighlight:k=!1,autoSelect:F=!1,blurOnSelect:M=!1,clearOnBlur:w=!s.freeSolo,clearOnEscape:C=!1,componentName:j="useAutocomplete",defaultValue:y=s.multiple?Ts:null,disableClearable:U=!1,disableCloseOnSelect:G=!1,disabled:A,disabledItemsFocusable:he=!1,disableListWrap:ne=!1,filterOptions:me=ys,filterSelectedOptions:Z=!1,freeSolo:K=!1,getOptionDisabled:V,getOptionKey:ge,getOptionLabel:p=t=>t.label??t,groupBy:b,handleHomeEndKeys:l=!s.freeSolo,id:f,includeInputInList:D=!1,inputValue:z,isOptionEqualToValue:le=(t,e)=>t===e,multiple:h=!1,onChange:it,onClose:lt,onHighlightChange:ze,onInputChange:xe,onOpen:He,open:At,openOnFocus:Pt=!1,options:Ot,readOnly:ce=!1,renderValue:W,selectOnFocus:ct=!s.freeSolo,value:Be}=s,H=as(f);let L=p;L=t=>{const e=p(t);return typeof e!="string"?String(e):e};const ke=g.useRef(!1),Me=g.useRef(!0),$=g.useRef(null),Y=g.useRef(null),[Ne,jt]=g.useState(null),[B,Ge]=g.useState(-1),ut=k?0:-1,v=g.useRef(ut),$t=g.useRef(qt(y??Be,h,L)).current,[i,Fe]=It({controlled:Be,default:y,name:j}),[I,De]=It({controlled:z,default:$t,name:j,state:"inputValue"}),[Pe,Ke]=g.useState(!1),Oe=g.useCallback((t,e,n)=>{if(!(h?i.length<e.length:e!==null)&&!w)return;const r=qt(e,h,L,W);I!==r&&(De(r),xe&&xe(t,r,n))},[L,I,h,xe,De,w,i,W]),[ue,Te]=It({controlled:At,default:!1,name:j,state:"open"}),[vt,je]=g.useState(!0),Ye=!h&&i!=null&&I===L(i),q=ue&&!ce,T=q?me(Ot.filter(t=>!(Z&&(h?i:[i]).some(e=>e!==null&&le(t,e)))),{inputValue:Ye&&vt?"":I,getOptionLabel:L}):[],ee=rs({filteredOptions:T,value:i,inputValue:I});g.useEffect(()=>{const t=i!==ee.value;Pe&&!t||K&&!t||Oe(null,i,"reset")},[i,Oe,Pe,ee.value,K]);const Qe=ue&&T.length>0&&!ce,te=ot(t=>{if(t===-1)$.current.focus();else{const e=W?"data-item-index":"data-tag-index";Ne.querySelector(`[${e}="${t}"]`).focus()}});g.useEffect(()=>{h&&B>i.length-1&&(Ge(-1),te(-1))},[i,h,B,te]);function dt(t,e){if(!Y.current||t<0||t>=T.length)return-1;let n=t;for(;;){const u=Y.current.querySelector(`[data-option-index="${n}"]`),r=he?!1:!u||u.disabled||u.getAttribute("aria-disabled")==="true";if(u&&u.hasAttribute("tabindex")&&!r)return n;if(e==="next"?n=(n+1)%T.length:n=(n-1+T.length)%T.length,n===t)return-1}}const de=ot(({event:t,index:e,reason:n})=>{if(v.current=e,e===-1?$.current.removeAttribute("aria-activedescendant"):$.current.setAttribute("aria-activedescendant",`${H}-option-${e}`),ze&&["mouse","keyboard","touch"].includes(n)&&ze(t,e===-1?null:T[e],n),!Y.current)return;const u=Y.current.querySelector(`[role="option"].${d}-focused`);u&&(u.classList.remove(`${d}-focused`),u.classList.remove(`${d}-focusVisible`));let r=Y.current;if(Y.current.getAttribute("role")!=="listbox"&&(r=Y.current.parentElement.querySelector('[role="listbox"]')),!r)return;if(e===-1){r.scrollTop=0;return}const S=Y.current.querySelector(`[data-option-index="${e}"]`);if(S&&(S.classList.add(`${d}-focused`),n==="keyboard"&&S.classList.add(`${d}-focusVisible`),r.scrollHeight>r.clientHeight&&n!=="mouse"&&n!=="touch")){const E=S,Q=r.clientHeight+r.scrollTop,bt=E.offsetTop+E.offsetHeight;bt>Q?r.scrollTop=bt-r.clientHeight:E.offsetTop-E.offsetHeight*(b?1.3:0)<r.scrollTop&&(r.scrollTop=E.offsetTop-E.offsetHeight*(b?1.3:0))}}),se=ot(({event:t,diff:e,direction:n="next",reason:u})=>{if(!q)return;const S=dt((()=>{const E=T.length-1;if(e==="reset")return ut;if(e==="start")return 0;if(e==="end")return E;const Q=v.current+e;return Q<0?Q===-1&&D?-1:ne&&v.current!==-1||Math.abs(e)>1?0:E:Q>E?Q===E+1&&D?-1:ne||Math.abs(e)>1?E:0:Q})(),n);if(de({index:S,reason:u,event:t}),x&&e!=="reset")if(S===-1)$.current.value=I;else{const E=L(T[S]);$.current.value=E,E.toLowerCase().indexOf(I.toLowerCase())===0&&I.length>0&&$.current.setSelectionRange(I.length,E.length)}}),pt=()=>{const t=(e,n)=>{const u=e?L(e):"",r=n?L(n):"";return u===r};if(v.current!==-1&&ee.filteredOptions&&ee.filteredOptions.length!==T.length&&ee.inputValue===I&&(h?i.length===ee.value.length&&ee.value.every((e,n)=>L(i[n])===L(e)):t(ee.value,i))){const e=ee.filteredOptions[v.current];if(e)return T.findIndex(n=>L(n)===L(e))}return-1},Ve=g.useCallback(()=>{if(!q)return;const t=pt();if(t!==-1){v.current=t;return}const e=h?i[0]:i;if(T.length===0||e==null){se({diff:"reset"});return}if(Y.current){if(e!=null){const n=T[v.current];if(h&&n&&i.findIndex(r=>le(n,r))!==-1)return;const u=T.findIndex(r=>le(r,e));u===-1?se({diff:"reset"}):de({index:u});return}if(v.current>=T.length-1){de({index:T.length-1});return}de({index:v.current})}},[T.length,h?!1:i,Z,se,de,q,I,h]),ft=ot(t=>{is(Y,t),t&&Ve()});g.useEffect(()=>{Ve()},[Ve]);const _=t=>{ue||(Te(!0),je(!0),He&&He(t))},Se=(t,e)=>{ue&&(Te(!1),lt&&lt(t,e))},pe=(t,e,n,u)=>{if(h){if(i.length===e.length&&i.every((r,S)=>r===e[S]))return}else if(i===e)return;it&&it(t,e,n,u),Fe(e)},$e=g.useRef(!1),ae=(t,e,n="selectOption",u="options")=>{let r=n,S=e;if(h){S=Array.isArray(i)?i.slice():[];const E=S.findIndex(Q=>le(e,Q));E===-1?S.push(e):u!=="freeSolo"&&(S.splice(E,1),r="removeOption")}Oe(t,S,r),pe(t,S,r,{option:e}),!G&&(!t||!t.ctrlKey&&!t.metaKey)&&Se(t,r),(M===!0||M==="touch"&&$e.current||M==="mouse"&&!$e.current)&&$.current.blur()};function Xe(t,e){if(t===-1)return-1;let n=t;for(;;){if(e==="next"&&n===i.length||e==="previous"&&n===-1)return-1;const u=W?"data-item-index":"data-tag-index",r=Ne.querySelector(`[${u}="${n}"]`);if(!r||!r.hasAttribute("tabindex")||r.disabled||r.getAttribute("aria-disabled")==="true")n+=e==="next"?1:-1;else return n}}const Je=(t,e)=>{if(!h)return;I===""&&Se(t,"toggleInput");let n=B;B===-1?I===""&&e==="previous"&&(n=i.length-1):(n+=e==="next"?1:-1,n<0&&(n=0),n===i.length&&(n=-1)),n=Xe(n,e),Ge(n),te(n)},Ee=t=>{ke.current=!0,De(""),xe&&xe(t,"","clear"),pe(t,h?[]:null,"clear")},ht=t=>e=>{if(t.onKeyDown&&t.onKeyDown(e),!e.defaultMuiPrevented&&(B!==-1&&!["ArrowLeft","ArrowRight"].includes(e.key)&&(Ge(-1),te(-1)),e.which!==229))switch(e.key){case"Home":q&&l&&(e.preventDefault(),se({diff:"start",direction:"next",reason:"keyboard",event:e}));break;case"End":q&&l&&(e.preventDefault(),se({diff:"end",direction:"previous",reason:"keyboard",event:e}));break;case"PageUp":e.preventDefault(),se({diff:-Wt,direction:"previous",reason:"keyboard",event:e}),_(e);break;case"PageDown":e.preventDefault(),se({diff:Wt,direction:"next",reason:"keyboard",event:e}),_(e);break;case"ArrowDown":e.preventDefault(),se({diff:1,direction:"next",reason:"keyboard",event:e}),_(e);break;case"ArrowUp":e.preventDefault(),se({diff:-1,direction:"previous",reason:"keyboard",event:e}),_(e);break;case"ArrowLeft":!h&&W?te(0):Je(e,"previous");break;case"ArrowRight":!h&&W?te(-1):Je(e,"next");break;case"Enter":if(v.current!==-1&&q){const n=T[v.current],u=V?V(n):!1;if(e.preventDefault(),u)return;ae(e,n,"selectOption"),x&&$.current.setSelectionRange($.current.value.length,$.current.value.length)}else K&&I!==""&&Ye===!1&&(h&&e.preventDefault(),ae(e,I,"createOption","freeSolo"));break;case"Escape":q?(e.preventDefault(),e.stopPropagation(),Se(e,"escape")):C&&(I!==""||h&&i.length>0||W)&&(e.preventDefault(),e.stopPropagation(),Ee(e));break;case"Backspace":if(h&&!ce&&I===""&&i.length>0){const n=B===-1?i.length-1:B,u=i.slice();u.splice(n,1),pe(e,u,"removeOption",{option:i[n]})}!h&&W&&!ce&&(Fe(null),te(-1));break;case"Delete":if(h&&!ce&&I===""&&i.length>0&&B!==-1){const n=B,u=i.slice();u.splice(n,1),pe(e,u,"removeOption",{option:i[n]})}!h&&W&&!ce&&(Fe(null),te(-1));break}},mt=t=>{Ke(!0),Pt&&!ke.current&&_(t)},Ce=t=>{if(a(Y)){$.current.focus();return}Ke(!1),Me.current=!0,ke.current=!1,F&&v.current!==-1&&q?ae(t,T[v.current],"blur"):F&&K&&I!==""?ae(t,I,"blur","freeSolo"):w&&Oe(t,i,"blur"),Se(t,"blur")},We=t=>{const e=t.target.value;I!==e&&(De(e),je(!1),xe&&xe(t,e,"input")),e===""?!U&&!h&&pe(t,null,"clear"):_(t)},qe=t=>{const e=Number(t.currentTarget.getAttribute("data-option-index"));v.current!==e&&de({event:t,index:e,reason:"mouse"})},gt=t=>{de({event:t,index:Number(t.currentTarget.getAttribute("data-option-index")),reason:"touch"}),$e.current=!0},xt=t=>{const e=Number(t.currentTarget.getAttribute("data-option-index"));ae(t,T[e],"selectOption"),$e.current=!1},Ze=t=>e=>{const n=i.slice();n.splice(t,1),pe(e,n,"removeOption",{option:i[t]})},wt=t=>{pe(t,null,"removeOption",{option:i})},ve=t=>{ue?Se(t,"toggleInput"):_(t)},P=t=>{t.currentTarget.contains(t.target)&&t.target.getAttribute("id")!==H&&t.preventDefault()},O=t=>{t.currentTarget.contains(t.target)&&($.current.focus(),ct&&Me.current&&$.current.selectionEnd-$.current.selectionStart===0&&$.current.select(),Me.current=!1)},be=t=>{!A&&(I===""||!ue)&&ve(t)};let _e=K&&I.length>0;_e=_e||(h?i.length>0:i!==null);let et=T;return b&&(et=T.reduce((t,e,n)=>{const u=b(e);return t.length>0&&t[t.length-1].group===u?t[t.length-1].options.push(e):t.push({key:n,index:n,group:u,options:[e]}),t},[])),A&&Pe&&Ce(),{getRootProps:(t={})=>({...t,onKeyDown:ht(t),onMouseDown:P,onClick:O}),getInputLabelProps:()=>({id:`${H}-label`,htmlFor:H}),getInputProps:()=>({id:H,value:I,onBlur:Ce,onFocus:mt,onChange:We,onMouseDown:be,"aria-activedescendant":q?"":null,"aria-autocomplete":x?"both":"list","aria-controls":Qe?`${H}-listbox`:void 0,"aria-expanded":Qe,autoComplete:"off",ref:$,autoCapitalize:"none",spellCheck:"false",role:"combobox",disabled:A}),getClearProps:()=>({tabIndex:-1,type:"button",onClick:Ee}),getItemProps:({index:t=0}={})=>({...h&&{key:t},...W?{"data-item-index":t}:{"data-tag-index":t},tabIndex:-1,...!ce&&{onDelete:h?Ze(t):wt}}),getPopupIndicatorProps:()=>({tabIndex:-1,type:"button",onClick:ve}),getTagProps:({index:t})=>({key:t,"data-tag-index":t,tabIndex:-1,...!ce&&{onDelete:Ze(t)}}),getListboxProps:()=>({role:"listbox",id:`${H}-listbox`,"aria-labelledby":`${H}-label`,ref:ft,onMouseDown:t=>{t.preventDefault()}}),getOptionProps:({index:t,option:e})=>{const n=(h?i:[i]).some(r=>r!=null&&le(e,r)),u=V?V(e):!1;return{key:(ge==null?void 0:ge(e))??L(e),tabIndex:-1,role:"option",id:`${H}-option-${t}`,onMouseMove:qe,onClick:xt,onTouchStart:gt,"data-option-index":t,"aria-disabled":u,"aria-selected":n}},id:H,inputValue:I,value:i,dirty:_e,expanded:q&&Ne,popupOpen:q,focused:Pe||B!==-1,anchorEl:Ne,setAnchorEl:jt,focusedItem:B,focusedTag:B,groupedOptions:et}}var _t,Ut;const Es=s=>{const{classes:a,disablePortal:d,expanded:x,focused:k,fullWidth:F,hasClearIcon:M,hasPopupIcon:w,inputFocused:C,popupOpen:j,size:y}=s,U={root:["root",x&&"expanded",k&&"focused",F&&"fullWidth",M&&"hasClearIcon",w&&"hasPopupIcon"],inputRoot:["inputRoot"],input:["input",C&&"inputFocused"],tag:["tag",`tagSize${Bt(y)}`],endAdornment:["endAdornment"],clearIndicator:["clearIndicator"],popupIndicator:["popupIndicator",j&&"popupIndicatorOpen"],popper:["popper",d&&"popperDisablePortal"],paper:["paper"],listbox:["listbox"],loading:["loading"],noOptions:["noOptions"],option:["option"],groupLabel:["groupLabel"],groupUl:["groupUl"]};return us(U,ds,a)},Cs=oe("div",{name:"MuiAutocomplete",slot:"Root",overridesResolver:(s,a)=>{const{ownerState:d}=s,{fullWidth:x,hasClearIcon:k,hasPopupIcon:F,inputFocused:M,size:w}=d;return[{[`& .${c.tag}`]:a.tag},{[`& .${c.tag}`]:a[`tagSize${Bt(w)}`]},{[`& .${c.inputRoot}`]:a.inputRoot},{[`& .${c.input}`]:a.input},{[`& .${c.input}`]:M&&a.inputFocused},a.root,x&&a.fullWidth,F&&a.hasPopupIcon,k&&a.hasClearIcon]}})({[`&.${c.focused} .${c.clearIndicator}`]:{visibility:"visible"},"@media (pointer: fine)":{[`&:hover .${c.clearIndicator}`]:{visibility:"visible"}},[`& .${c.tag}`]:{margin:3,maxWidth:"calc(100% - 6px)"},[`& .${c.inputRoot}`]:{[`.${c.hasPopupIcon}&, .${c.hasClearIcon}&`]:{paddingRight:30},[`.${c.hasPopupIcon}.${c.hasClearIcon}&`]:{paddingRight:56},[`& .${c.input}`]:{width:0,minWidth:30}},[`& .${St.root}`]:{paddingBottom:1,"& .MuiInput-input":{padding:"4px 4px 4px 0px"}},[`& .${St.root}.${Ae.sizeSmall}`]:{[`& .${St.input}`]:{padding:"2px 4px 3px 0"}},[`& .${Rt.root}`]:{padding:9,[`.${c.hasPopupIcon}&, .${c.hasClearIcon}&`]:{paddingRight:39},[`.${c.hasPopupIcon}.${c.hasClearIcon}&`]:{paddingRight:65},[`& .${c.input}`]:{padding:"7.5px 4px 7.5px 5px"},[`& .${c.endAdornment}`]:{right:9}},[`& .${Rt.root}.${Ae.sizeSmall}`]:{paddingTop:6,paddingBottom:6,paddingLeft:6,[`& .${c.input}`]:{padding:"2.5px 4px 2.5px 8px"}},[`& .${we.root}`]:{paddingTop:19,paddingLeft:8,[`.${c.hasPopupIcon}&, .${c.hasClearIcon}&`]:{paddingRight:39},[`.${c.hasPopupIcon}.${c.hasClearIcon}&`]:{paddingRight:65},[`& .${we.input}`]:{padding:"7px 4px"},[`& .${c.endAdornment}`]:{right:9}},[`& .${we.root}.${Ae.sizeSmall}`]:{paddingBottom:1,[`& .${we.input}`]:{padding:"2.5px 4px"}},[`& .${Ae.hiddenLabel}`]:{paddingTop:8},[`& .${we.root}.${Ae.hiddenLabel}`]:{paddingTop:0,paddingBottom:0,[`& .${c.input}`]:{paddingTop:16,paddingBottom:17}},[`& .${we.root}.${Ae.hiddenLabel}.${Ae.sizeSmall}`]:{[`& .${c.input}`]:{paddingTop:8,paddingBottom:9}},[`& .${c.input}`]:{flexGrow:1,textOverflow:"ellipsis",opacity:0},variants:[{props:{fullWidth:!0},style:{width:"100%"}},{props:{size:"small"},style:{[`& .${c.tag}`]:{margin:2,maxWidth:"calc(100% - 4px)"}}},{props:{inputFocused:!0},style:{[`& .${c.input}`]:{opacity:1}}},{props:{multiple:!0},style:{[`& .${c.inputRoot}`]:{flexWrap:"wrap"}}}]}),As=oe("div",{name:"MuiAutocomplete",slot:"EndAdornment"})({position:"absolute",right:0,top:"50%",transform:"translate(0, -50%)"}),Ps=oe(Gt,{name:"MuiAutocomplete",slot:"ClearIndicator"})({marginRight:-2,padding:4,visibility:"hidden"}),Os=oe(Gt,{name:"MuiAutocomplete",slot:"PopupIndicator",overridesResolver:(s,a)=>{const{ownerState:d}=s;return[a.popupIndicator,d.popupOpen&&a.popupIndicatorOpen]}})({padding:2,marginRight:-2,variants:[{props:{popupOpen:!0},style:{transform:"rotate(180deg)"}}]}),js=oe(Ht,{name:"MuiAutocomplete",slot:"Popper",overridesResolver:(s,a)=>{const{ownerState:d}=s;return[{[`& .${c.option}`]:a.option},a.popper,d.disablePortal&&a.popperDisablePortal]}})(Re(({theme:s})=>({zIndex:(s.vars||s).zIndex.modal,variants:[{props:{disablePortal:!0},style:{position:"absolute"}}]}))),$s=oe(zt,{name:"MuiAutocomplete",slot:"Paper"})(Re(({theme:s})=>({...s.typography.body1,overflow:"auto"}))),vs=oe("div",{name:"MuiAutocomplete",slot:"Loading"})(Re(({theme:s})=>({color:(s.vars||s).palette.text.secondary,padding:"14px 16px"}))),ws=oe("div",{name:"MuiAutocomplete",slot:"NoOptions"})(Re(({theme:s})=>({color:(s.vars||s).palette.text.secondary,padding:"14px 16px"}))),Ls=oe("ul",{name:"MuiAutocomplete",slot:"Listbox"})(Re(({theme:s})=>({listStyle:"none",margin:0,padding:"8px 0",maxHeight:"40vh",overflow:"auto",position:"relative",[`& .${c.option}`]:{minHeight:48,display:"flex",overflow:"hidden",justifyContent:"flex-start",alignItems:"center",cursor:"pointer",paddingTop:6,boxSizing:"border-box",outline:"0",WebkitTapHighlightColor:"transparent",paddingBottom:6,paddingLeft:16,paddingRight:16,[s.breakpoints.up("sm")]:{minHeight:"auto"},[`&.${c.focused}`]:{backgroundColor:(s.vars||s).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},'&[aria-disabled="true"]':{opacity:(s.vars||s).palette.action.disabledOpacity,pointerEvents:"none"},[`&.${c.focusVisible}`]:{backgroundColor:(s.vars||s).palette.action.focus},'&[aria-selected="true"]':{backgroundColor:s.vars?`rgba(${s.vars.palette.primary.mainChannel} / ${s.vars.palette.action.selectedOpacity})`:Tt(s.palette.primary.main,s.palette.action.selectedOpacity),[`&.${c.focused}`]:{backgroundColor:s.vars?`rgba(${s.vars.palette.primary.mainChannel} / calc(${s.vars.palette.action.selectedOpacity} + ${s.vars.palette.action.hoverOpacity}))`:Tt(s.palette.primary.main,s.palette.action.selectedOpacity+s.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:(s.vars||s).palette.action.selected}},[`&.${c.focusVisible}`]:{backgroundColor:s.vars?`rgba(${s.vars.palette.primary.mainChannel} / calc(${s.vars.palette.action.selectedOpacity} + ${s.vars.palette.action.focusOpacity}))`:Tt(s.palette.primary.main,s.palette.action.selectedOpacity+s.palette.action.focusOpacity)}}}}))),Rs=oe(ps,{name:"MuiAutocomplete",slot:"GroupLabel"})(Re(({theme:s})=>({backgroundColor:(s.vars||s).palette.background.paper,top:-8}))),ks=oe("ul",{name:"MuiAutocomplete",slot:"GroupUl"})({padding:0,[`& .${c.option}`]:{paddingLeft:24}}),os=g.forwardRef(function(a,d){const x=ls({props:a,name:"MuiAutocomplete"}),{autoComplete:k=!1,autoHighlight:F=!1,autoSelect:M=!1,blurOnSelect:w=!1,ChipProps:C,className:j,clearIcon:y=_t||(_t=o.jsx(cs,{fontSize:"small"})),clearOnBlur:U=!x.freeSolo,clearOnEscape:G=!1,clearText:A="Clear",closeText:he="Close",componentsProps:ne,defaultValue:me=x.multiple?[]:null,disableClearable:Z=!1,disableCloseOnSelect:K=!1,disabled:V=!1,disabledItemsFocusable:ge=!1,disableListWrap:p=!1,disablePortal:b=!1,filterOptions:l,filterSelectedOptions:f=!1,forcePopupIcon:D="auto",freeSolo:z=!1,fullWidth:le=!1,getLimitTagsText:h=m=>`+${m}`,getOptionDisabled:it,getOptionKey:lt,getOptionLabel:ze,isOptionEqualToValue:xe,groupBy:He,handleHomeEndKeys:At=!x.freeSolo,id:Pt,includeInputInList:Ot=!1,inputValue:ce,limitTags:W=-1,ListboxComponent:ct,ListboxProps:Be,loading:H=!1,loadingText:L="Loadingâ€¦",multiple:ke=!1,noOptionsText:Me="No options",onChange:$,onClose:Y,onHighlightChange:Ne,onInputChange:jt,onOpen:B,open:Ge,openOnFocus:ut=!1,openText:v="Open",options:$t,PaperComponent:i,PopperComponent:Fe,popupIcon:I=Ut||(Ut=o.jsx(ms,{})),readOnly:De=!1,renderGroup:Pe,renderInput:Ke,renderOption:Oe,renderTags:ue,renderValue:Te,selectOnFocus:vt=!x.freeSolo,size:je="medium",slots:Ye={},slotProps:q={},value:T,...ee}=x,{getRootProps:Qe,getInputProps:te,getInputLabelProps:dt,getPopupIndicatorProps:de,getClearProps:se,getItemProps:pt,getListboxProps:Ve,getOptionProps:ft,value:_,dirty:Se,expanded:pe,id:$e,popupOpen:ae,focused:Xe,focusedItem:Je,anchorEl:Ee,setAnchorEl:ht,inputValue:mt,groupedOptions:Ce}=Ss({...x,componentName:"Autocomplete"}),We=!Z&&!V&&Se&&!De,qe=(!z||D===!0)&&D!==!1,{onMouseDown:gt}=te(),{ref:xt,...Ze}=Ve(),ve=ze||(m=>m.label??m),P={...x,disablePortal:b,expanded:pe,focused:Xe,fullWidth:le,getOptionLabel:ve,hasClearIcon:We,hasPopupIcon:qe,inputFocused:Je===-1,popupOpen:ae,size:je},O=Es(P),be={slots:{paper:i,popper:Fe,...Ye},slotProps:{chip:C,listbox:Be,...ne,...q}},[_e,et]=yt("listbox",{elementType:Ls,externalForwardedProps:be,ownerState:P,className:O.listbox,additionalProps:Ze,ref:xt}),[t,e]=yt("paper",{elementType:zt,externalForwardedProps:be,ownerState:P,className:O.paper}),[n,u]=yt("popper",{elementType:Ht,externalForwardedProps:be,ownerState:P,className:O.popper,additionalProps:{disablePortal:b,style:{width:Ee?Ee.clientWidth:null},role:"presentation",anchorEl:Ee,open:ae}});let r;const S=m=>({className:O.tag,disabled:V,...pt(m)});if(ke?_.length>0&&(ue?r=ue(_,S,P):Te?r=Te(_,S,P):r=_.map((m,Ie)=>{const{key:ye,...Ue}=S({index:Ie});return o.jsx(gs,{label:ve(m),size:je,...Ue,...be.slotProps.chip},ye)})):Te&&_!=null&&(r=Te(_,S,P)),W>-1&&Array.isArray(r)){const m=r.length-W;!Xe&&m>0&&(r=r.splice(0,W),r.push(o.jsx("span",{className:O.tag,children:h(m)},r.length)))}const Q=Pe||(m=>o.jsxs("li",{children:[o.jsx(Rs,{className:O.groupLabel,ownerState:P,component:"div",children:m.group}),o.jsx(ks,{className:O.groupUl,ownerState:P,children:m.children})]},m.key)),ns=Oe||((m,Ie)=>{const{key:ye,...Ue}=m;return o.jsx("li",{...Ue,children:ve(Ie)},ye)}),Lt=(m,Ie)=>{const ye=ft({option:m,index:Ie});return ns({...ye,className:O.option},m,{selected:ye["aria-selected"],index:Ie,inputValue:mt},P)},tt=be.slotProps.clearIndicator,st=be.slotProps.popupIndicator;return o.jsxs(g.Fragment,{children:[o.jsx(Cs,{ref:d,className:Dt(O.root,j),ownerState:P,...Qe(ee),children:Ke({id:$e,disabled:V,fullWidth:!0,size:je==="small"?"small":void 0,InputLabelProps:dt(),InputProps:{ref:ht,className:O.inputRoot,startAdornment:r,onMouseDown:m=>{m.target===m.currentTarget&&gt(m)},...(We||qe)&&{endAdornment:o.jsxs(As,{className:O.endAdornment,ownerState:P,children:[We?o.jsx(Ps,{...se(),"aria-label":A,title:A,ownerState:P,...tt,className:Dt(O.clearIndicator,tt==null?void 0:tt.className),children:y}):null,qe?o.jsx(Os,{...de(),disabled:V,"aria-label":ae?he:v,title:ae?he:v,ownerState:P,...st,className:Dt(O.popupIndicator,st==null?void 0:st.className),children:I}):null]})}},inputProps:{className:O.input,disabled:V,readOnly:De,...te()}})}),Ee?o.jsx(js,{as:n,...u,children:o.jsxs($s,{as:t,...e,children:[H&&Ce.length===0?o.jsx(vs,{className:O.loading,ownerState:P,children:L}):null,Ce.length===0&&!z&&!H?o.jsx(ws,{className:O.noOptions,ownerState:P,role:"presentation",onMouseDown:m=>{m.preventDefault()},children:Me}):null,Ce.length>0?o.jsx(_e,{as:ct,...et,children:Ce.map((m,Ie)=>He?Q({key:m.key,group:m.group,children:m.options.map((ye,Ue)=>Lt(ye,m.index+Ue))}):Lt(m,Ie))}):null]})}):null]})}),Ms=rt({WEEKDAY:R().min(1,{message:"Weekday is required!"}),START_TIME:R().min(1,{message:"Start time is required!"}),END_TIME:R().min(1,{message:"End time is required!"})}).refine(s=>{const a=new Date(`2000-01-01T${s.START_TIME}`);return new Date(`2000-01-01T${s.END_TIME}`)>a},{message:"End time must be after start time",path:["END_TIME"]}),Ns=rt({title:R().min(1,{message:"Course title is required!"}),location:R().min(1,{message:"Location is required!"}),startDate:R().min(1,{message:"Start date is required!"}),endDate:R().min(1,{message:"End date is required!"}),description:R().optional(),capacity:es().min(1,{message:"Capacity must be at least 1"}),instructors:at(ts()).min(1,{message:"At least one instructor is required!"}),schedule:at(Ms).min(1,{message:"At least one schedule entry is required!"})}).refine(s=>{const a=s.schedule.map(x=>x.WEEKDAY),d=[...new Set(a)];return a.length===d.length},{message:"Each day of the week can only appear once in the schedule",path:["schedule"]}).refine(s=>{const a=new Date(s.startDate);return new Date(s.endDate)>=a},{message:"End date must be after or equal to start date",path:["endDate"]});function Hs({currentCourse:s}){const a=fs(),[d,x]=g.useState([]),[k,F]=g.useState(!1),[M,w]=g.useState(!0),C=g.useMemo(()=>({title:"",location:"",startDate:"",endDate:"",description:"",capacity:20,instructors:[],schedule:[{WEEKDAY:"Monday",START_TIME:"09:00",END_TIME:"10:00"}]}),[]),j=Yt({mode:"onChange",resolver:Qt(Ns),defaultValues:C}),{reset:y,handleSubmit:U,watch:G,setValue:A,formState:{isSubmitting:he,isDirty:ne}}=j,me=G("schedule")||[],Z=g.useCallback(p=>p?{title:p.TITLE||"",location:p.LOCATION||"",startDate:p.STARTDATE?p.STARTDATE.split("T")[0]:"",endDate:p.ENDDATE?p.ENDDATE.split("T")[0]:"",description:p.DESCRIPTION||"",capacity:p.CAPACITY||20,instructors:p.instructors||[],schedule:p.schedule||[{WEEKDAY:"Monday",START_TIME:"09:00",END_TIME:"10:00"}]}:C,[C]);g.useEffect(()=>{(async()=>{try{w(!0);const b=await re.get(ie.roles.byName("Instructor"));if(x(b.data.users||[]),s!=null&&s.COURSEID)try{const[l,f]=await Promise.all([re.get(ie.courses.instructors(s.COURSEID)),re.get(ie.courses.schedule(s.COURSEID))]),D={...s,instructors:l.data.instructors||[],schedule:f.data.schedule||[]},z=Z(D);y(z)}catch(l){console.error("Error fetching course details:",l);const f=Z(s);y(f)}}catch(b){console.error("Error fetching instructors:",b),fe.error("Failed to load instructors")}finally{w(!1)}})()},[s,Z,y]);const K=p=>{A("schedule",p,{shouldValidate:!0,shouldDirty:!0})},V=p=>!p||p.length===0?"No schedule set":p.map(b=>`${b.WEEKDAY} ${b.START_TIME}-${b.END_TIME}`).join(", "),ge=U(async p=>{try{const b={...p,instructors:p.instructors.map(l=>l.UID)};s?(await re.put(ie.courses.details(s.COURSEID),b),fe.success("Course updated successfully!")):(await re.post(ie.courses.list,b),fe.success("Course created successfully!")),y(),a.push(kt.dashboard.courses)}catch(b){console.error("Error saving course:",b),fe.error(s?"Failed to update course!":"Failed to create course!")}});return M?o.jsx(X,{sx:{display:"flex",justifyContent:"center",py:4},children:o.jsx(N,{children:"Loading course data..."})}):o.jsxs(Xt,{methods:j,onSubmit:ge,children:[o.jsxs(Ct,{container:!0,spacing:3,children:[o.jsx(Ct,{size:{xs:12,md:4},children:o.jsxs(Et,{sx:{pt:10,pb:5,px:3},children:[o.jsxs(X,{sx:{mb:5},children:[o.jsx(N,{variant:"h6",sx:{mb:2},children:"Course Information"}),o.jsx(N,{variant:"body2",sx:{color:"text.secondary"},children:"Fill in the course details below. All required fields must be completed."})]}),s&&o.jsx(Ft,{sx:{mt:3,alignItems:"center",justifyContent:"center"},children:o.jsx(Le,{variant:"soft",color:"error",onClick:async()=>{try{await re.delete(ie.courses.details(s.COURSEID)),fe.success("Course deleted successfully!"),a.push(kt.dashboard.courses)}catch(p){console.error("Error deleting course:",p),fe.error("Failed to delete course!")}},children:"Delete course"})})]})}),o.jsx(Ct,{size:{xs:12,md:8},children:o.jsxs(Et,{sx:{p:3},children:[o.jsxs(X,{sx:{rowGap:3,columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)"}},children:[o.jsx(J.Text,{name:"title",label:"Course Title"}),o.jsx(J.Text,{name:"location",label:"Location"}),o.jsx(J.Text,{name:"startDate",label:"Start Date",type:"date",InputLabelProps:{shrink:!0}}),o.jsx(J.Text,{name:"endDate",label:"End Date",type:"date",InputLabelProps:{shrink:!0}}),o.jsx(J.Text,{name:"capacity",label:"Capacity",type:"number"}),o.jsx(J.Text,{name:"description",label:"Description",multiline:!0,rows:4,sx:{gridColumn:{xs:"span 1",sm:"span 2"}}})]}),o.jsx(nt,{sx:{my:3}}),o.jsxs(X,{sx:{mb:3},children:[o.jsx(N,{variant:"h6",sx:{mb:2},children:"Instructors"}),o.jsx(N,{variant:"body2",sx:{color:"text.secondary",mb:2},children:"Select one or more instructors for this course"}),o.jsx(Jt,{name:"instructors",control:j.control,render:({field:p,fieldState:{error:b}})=>o.jsx(os,{...p,multiple:!0,options:d,getOptionLabel:l=>`${l.FIRSTNAME} ${l.LASTNAME}`,isOptionEqualToValue:(l,f)=>l.UID===f.UID,value:p.value||[],onChange:(l,f)=>{p.onChange(f),A("instructors",f,{shouldValidate:!0})},renderInput:l=>o.jsx(Zt,{...l,label:"Instructors",placeholder:"Select instructors...",error:!!b,helperText:b==null?void 0:b.message}),slotProps:{chip:{size:"small",variant:"soft"}}})})]}),o.jsx(nt,{sx:{my:3}}),o.jsxs(X,{sx:{mb:3},children:[o.jsxs(X,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[o.jsx(N,{variant:"h6",children:"Schedule"}),o.jsx(Le,{variant:"outlined",startIcon:o.jsx(Kt,{icon:"eva:edit-fill"}),onClick:()=>F(!0),children:me.length>0?"Edit Schedule":"Set Schedule"})]}),o.jsx(N,{variant:"body2",sx:{color:"text.secondary",mb:2},children:"Set the schedule for each day independently"}),o.jsx(Et,{sx:{p:2,bgcolor:"background.neutral"},children:o.jsx(N,{variant:"body2",sx:{color:"text.secondary"},children:V(me)})})]}),o.jsx(Ft,{sx:{mt:3,alignItems:"flex-end"},children:o.jsx(Le,{type:"submit",variant:"contained",loading:he,disabled:s&&!ne,children:s?ne?"Save changes":"No changes made":"Create course"})})]})})]}),o.jsx(ss,{open:k,onClose:()=>F(!1),onSave:K,initialSchedule:me})]})}const Fs=rt({WEEKDAY:R().min(1,{message:"Weekday is required!"}),START_TIME:R().min(1,{message:"Start time is required!"}),END_TIME:R().min(1,{message:"End time is required!"})}).refine(s=>{const a=new Date(`2000-01-01T${s.START_TIME}`);return new Date(`2000-01-01T${s.END_TIME}`)>a},{message:"End time must be after start time",path:["END_TIME"]}),Vs=rt({title:R().min(1,{message:"Course title is required!"}),location:R().min(1,{message:"Location is required!"}),startDate:R().min(1,{message:"Start date is required!"}),endDate:R().min(1,{message:"End date is required!"}),description:R().optional(),capacity:es().min(1,{message:"Capacity must be at least 1"}),instructors:at(ts()).min(1,{message:"At least one instructor is required!"}),schedule:at(Fs).min(1,{message:"At least one schedule entry is required!"})}).refine(s=>{const a=s.schedule.map(x=>x.WEEKDAY),d=[...new Set(a)];return a.length===d.length},{message:"Each day of the week can only appear once in the schedule",path:["schedule"]}).refine(s=>{const a=new Date(s.startDate);return new Date(s.endDate)>=a},{message:"End date must be after or equal to start date",path:["endDate"]});function Bs({currentCourse:s,open:a,onClose:d}){const[x,k]=g.useState([]),[F,M]=g.useState(!1),[w,C]=g.useState(!1),j=g.useMemo(()=>({title:"",location:"",startDate:"",endDate:"",description:"",capacity:20,instructors:[],schedule:[{WEEKDAY:"Monday",START_TIME:"09:00",END_TIME:"10:00"}]}),[]),y=g.useCallback(l=>l?{title:l.TITLE||"",location:l.LOCATION||"",startDate:l.STARTDATE?l.STARTDATE.split("T")[0]:"",endDate:l.ENDDATE?l.ENDDATE.split("T")[0]:"",description:l.DESCRIPTION||"",capacity:l.CAPACITY||20,instructors:l.instructors||[],schedule:l.schedule||[{WEEKDAY:"Monday",START_TIME:"09:00",END_TIME:"10:00"}]}:j,[j]),U=Yt({mode:"onSubmit",resolver:Qt(Vs),defaultValues:j}),{reset:G,handleSubmit:A,watch:he,setValue:ne,formState:{isSubmitting:me,isDirty:Z}}=U,K=he("schedule")||[];g.useEffect(()=>{a||C(!1)},[a]),g.useEffect(()=>{const l=async()=>{try{const f=await re.get(ie.roles.byName("Instructor"));k(f.data.users||[])}catch(f){console.error("Error fetching instructors:",f),fe.error("Failed to load instructors")}};a&&x.length===0&&l()},[a,x.length]),g.useEffect(()=>{a&&(s!=null&&s.COURSEID)?(async()=>{C(!0);try{const[f,D]=await Promise.all([re.get(ie.courses.instructors(s.COURSEID)),re.get(ie.courses.schedule(s.COURSEID))]),z={...s,instructors:f.data.instructors||[],schedule:D.data.schedule||[]},le=y(z);G(le)}catch(f){console.error("Error fetching course details:",f);const D=y(s);G(D)}finally{C(!1)}})():a&&C(!1)},[a,s,y,G]);const V=l=>{ne("schedule",l,{shouldValidate:!0,shouldDirty:!0})},ge=l=>!l||l.length===0?"No schedule set":l.map(f=>`${f.WEEKDAY} ${f.START_TIME}-${f.END_TIME}`).join(", "),p=A(async l=>{try{const f={...l,instructors:l.instructors.map(D=>D.UID||D.uid||D.id).filter(Boolean)};await re.put(ie.courses.details(s.COURSEID),f),fe.success("Course updated successfully!"),d(),G(),window.location.reload()}catch(f){console.error("Error updating course:",f),fe.error("Failed to update course!")}}),b=()=>{G(),C(!1),d()};return w?o.jsx(Mt,{fullWidth:!0,maxWidth:"md",open:a,onClose:b,PaperProps:{sx:{borderRadius:2}},children:o.jsx(Nt,{sx:{display:"flex",justifyContent:"center",py:4},children:o.jsx(N,{children:"Loading course data..."})})}):o.jsxs(o.Fragment,{children:[o.jsx(Mt,{fullWidth:!0,maxWidth:"md",open:a,onClose:b,PaperProps:{sx:{borderRadius:2}},children:o.jsxs(Xt,{methods:U,onSubmit:p,children:[o.jsx(xs,{children:o.jsx(X,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:o.jsx(N,{variant:"h6",children:"Edit Course"})})}),o.jsxs(Nt,{dividers:!0,sx:{pt:3},children:[o.jsx(hs,{severity:"info",sx:{mb:3},children:"Update the course information below. All required fields must be completed."}),o.jsxs(X,{sx:{rowGap:3,columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)"}},children:[o.jsx(J.Text,{name:"title",label:"Course Title"}),o.jsx(J.Text,{name:"location",label:"Location"}),o.jsx(J.Text,{name:"startDate",label:"Start Date",type:"date",InputLabelProps:{shrink:!0}}),o.jsx(J.Text,{name:"endDate",label:"End Date",type:"date",InputLabelProps:{shrink:!0}}),o.jsx(J.Text,{name:"capacity",label:"Capacity",type:"number"}),o.jsx(J.Text,{name:"description",label:"Description",multiline:!0,rows:4,sx:{gridColumn:{xs:"span 1",sm:"span 2"}}})]}),o.jsx(nt,{sx:{my:3}}),o.jsxs(X,{sx:{mb:3},children:[o.jsx(N,{variant:"h6",sx:{mb:2},children:"Instructors"}),o.jsx(N,{variant:"body2",sx:{color:"text.secondary",mb:2},children:"Select one or more instructors for this course"}),o.jsx(Jt,{name:"instructors",control:U.control,render:({field:l,fieldState:{error:f}})=>o.jsx(os,{...l,multiple:!0,options:x,getOptionLabel:D=>`${D.FIRSTNAME} ${D.LASTNAME}`,isOptionEqualToValue:(D,z)=>D.UID===z.UID,value:l.value||[],onChange:(D,z)=>{l.onChange(z),ne("instructors",z,{shouldValidate:!0})},renderInput:D=>o.jsx(Zt,{...D,label:"Instructors",placeholder:"Select instructors...",error:!!f,helperText:f==null?void 0:f.message}),slotProps:{chip:{size:"small",variant:"soft"}}})})]}),o.jsx(nt,{sx:{my:3}}),o.jsxs(X,{sx:{mb:3},children:[o.jsxs(X,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[o.jsx(N,{variant:"h6",children:"Schedule"}),o.jsx(Le,{variant:"outlined",startIcon:o.jsx(Kt,{icon:"eva:edit-fill"}),onClick:()=>M(!0),children:K.length>0?"Edit Schedule":"Set Schedule"})]}),o.jsx(N,{variant:"body2",sx:{color:"text.secondary",mb:2},children:"Set the schedule for each day independently"}),o.jsx(X,{sx:{p:2,bgcolor:"background.neutral",borderRadius:1},children:o.jsx(N,{variant:"body2",sx:{color:"text.secondary"},children:ge(K)})})]})]}),o.jsxs(bs,{sx:{px:3,pb:3},children:[o.jsx(Le,{variant:"outlined",color:"inherit",onClick:b,children:"Cancel"}),o.jsx(Le,{type:"submit",variant:"contained",loading:me,disabled:!Z,children:Z?"Save changes":"No changes made"})]})]})}),o.jsx(ss,{open:F,onClose:()=>M(!1),onSave:V,initialSchedule:K})]})}export{Bs as C,Hs as a};
