import{z as oe,E as le,r as a,G as N,O,j as e,e as ae,w as W,p as f,B as x,x as ie,y as P,k as u,T as t,ab as B,N as Y,I as p,d as j,K as $,A as ce,D as de}from"./index-B-O2wvL4.js";import{C as xe}from"./custom-breadcrumbs-C2AuKEDp.js";import{G as l}from"./Grid-Ba55pw_4.js";import{S as c}from"./Stack-BjYbPdpy.js";import{D as q,a as H}from"./DialogTitle-w8z7uk1s.js";import{D as K}from"./DialogActions-DZ5SCz5y.js";const Q={title:`My Courses | Student Dashboard - ${ae.appName}`};function Ce(){const y=oe(),{authenticated:v,user:s}=le(),[m,X]=a.useState([]),[D,J]=a.useState([]),[V,w]=a.useState(!0),[E,Z]=a.useState(0),[d,I]=a.useState(null),[ee,S]=a.useState(!1),[T,U]=a.useState(!1),[te,L]=a.useState(!1),[n,F]=a.useState(null),A=a.useCallback(async()=>{if(s!=null&&s.UID)try{w(!0);const o=(await N.get(O.courses.list)).data.courses||[],h=[],b=[];for(const C of o)try{const z=((await N.get(O.courses.students(C.COURSEID))).data.students||[]).find(se=>se.UID===s.UID);z?h.push({...C,enrollment:z}):b.push(C)}catch(M){console.error(`Error fetching enrollment for course ${C.COURSEID}:`,M),b.push(C)}X(h),J(b)}catch(r){console.error("Error fetching courses:",r)}finally{w(!1)}},[s==null?void 0:s.UID]);a.useEffect(()=>{v&&(s!=null&&s.UID)&&A()},[v,s==null?void 0:s.UID,A]);const re=async()=>{if(!(!d||!(s!=null&&s.UID))){U(!0);try{await N.post(O.courses.enroll(d.COURSEID,s.UID)),await A(),S(!1),I(null)}catch(r){console.error("Error enrolling in course:",r)}finally{U(!1)}}},ne=r=>{I(r),S(!0)},_=()=>{S(!1),I(null)},R=r=>{F(r),L(!0)},k=()=>{L(!1),F(null)};if(!v)return y.push("/login"),null;const g=r=>{const o=new Date,h=new Date(r.STARTDATE),b=new Date(r.ENDDATE);return h>o?{label:"Upcoming",color:"info"}:h<=o&&b>=o?{label:"Ongoing",color:"success"}:{label:"Completed",color:"default"}},G=r=>{switch(r.STATUS){case"active":return{label:"Active",color:"success"};case"completed":return{label:"Completed",color:"primary"};case"withdrawn":return{label:"Withdrawn",color:"warning"};case"failed":return{label:"Failed",color:"error"};default:return{label:"Unknown",color:"default"}}},i=r=>new Date(r).toLocaleDateString();return V?e.jsxs(e.Fragment,{children:[e.jsx("title",{children:Q.title}),e.jsx(W,{maxWidth:"xl",children:e.jsx("div",{children:"Loading your courses..."})})]}):e.jsxs(e.Fragment,{children:[e.jsx("title",{children:Q.title}),e.jsxs(W,{maxWidth:"xl",children:[e.jsx(xe,{heading:"My Courses",links:[{name:"Dashboard",href:f.dashboard.root},{name:"Student",href:f.dashboard.student.courses},{name:"My Courses"}],sx:{mb:{xs:3,md:5}}}),e.jsx(x,{sx:{mb:3},children:e.jsxs(ie,{value:E,onChange:(r,o)=>Z(o),children:[e.jsx(P,{label:`Enrolled Courses (${m.length})`}),e.jsx(P,{label:`Available Courses (${D.length})`})]})}),E===0&&e.jsx(e.Fragment,{children:m.length===0?e.jsxs(u,{sx:{p:4,textAlign:"center"},children:[e.jsx(t,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"You are not enrolled in any courses yet."}),e.jsx(t,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Switch to the “Available Courses” tab to enroll in courses."})]}):e.jsxs(l,{container:!0,spacing:3,children:[e.jsx(l,{item:!0,xs:12,md:4,children:e.jsxs(u,{sx:{p:3,textAlign:"center"},children:[e.jsx(t,{variant:"h4",color:"info.main",gutterBottom:!0,children:m.filter(r=>g(r).label==="Upcoming").length}),e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Upcoming Courses"}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Starting soon"})]})}),e.jsx(l,{item:!0,xs:12,md:4,children:e.jsxs(u,{sx:{p:3,textAlign:"center"},children:[e.jsx(t,{variant:"h4",color:"success.main",gutterBottom:!0,children:m.filter(r=>g(r).label==="Ongoing").length}),e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Ongoing Courses"}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Currently enrolled"})]})}),e.jsx(l,{item:!0,xs:12,md:4,children:e.jsxs(u,{sx:{p:3,textAlign:"center"},children:[e.jsx(t,{variant:"h4",color:"primary",gutterBottom:!0,children:m.filter(r=>g(r).label==="Completed").length}),e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Completed Courses"}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Finished courses"})]})}),m.map(r=>{const o=g(r),h=G(r.enrollment);return e.jsx(l,{item:!0,xs:12,md:6,lg:4,children:e.jsx(u,{sx:{p:3,height:"100%",border:"1px solid #e0e0e0",borderRadius:2,boxShadow:"0 4px 12px rgba(0,0,0,0.1)",transition:"all 0.3s ease","&:hover":{boxShadow:"0 8px 24px rgba(0,0,0,0.15)",transform:"translateY(-4px)",borderColor:"primary.main"}},children:e.jsxs(c,{spacing:2,children:[e.jsxs(x,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs(x,{sx:{flex:1},children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:r.TITLE}),e.jsxs(c,{direction:"row",spacing:1,flexWrap:"wrap",useFlexGap:!0,children:[e.jsx(B,{label:o.label,color:o.color,size:"small"}),e.jsx(B,{label:h.label,color:h.color,size:"small"})]})]}),e.jsx(Y,{size:"small",onClick:()=>R(r),sx:{color:"text.secondary","&:hover":{color:"primary.main"}},children:e.jsx(p,{icon:"eva:info-fill"})})]}),e.jsxs(x,{children:[e.jsxs(t,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:[e.jsx("strong",{children:"Location:"})," ",r.LOCATION]}),e.jsxs(t,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:[e.jsx("strong",{children:"Start Date:"})," ",i(r.STARTDATE)]}),e.jsxs(t,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:[e.jsx("strong",{children:"End Date:"})," ",i(r.ENDDATE)]}),e.jsxs(t,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:[e.jsx("strong",{children:"Enrolled:"})," ",i(r.enrollment.ENROLL_DATE)]}),r.enrollment.FINAL_GRADE&&e.jsxs(t,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:"Grade:"})," ",r.enrollment.FINAL_GRADE,"%"]})]}),e.jsxs(c,{direction:"row",spacing:1,children:[e.jsx(j,{size:"small",variant:"outlined",startIcon:e.jsx(p,{icon:"eva:calendar-fill"}),onClick:()=>y.push(f.dashboard.student.schedule),children:"Schedule"}),e.jsx(j,{size:"small",variant:"outlined",startIcon:e.jsx(p,{icon:"eva:file-text-fill"}),onClick:()=>y.push(f.dashboard.student.grades),children:"Grades"})]})]})})},r.COURSEID)})]})}),E===1&&e.jsx(e.Fragment,{children:D.length===0?e.jsxs(u,{sx:{p:4,textAlign:"center"},children:[e.jsx(t,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"No available courses to enroll in."}),e.jsx(t,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"All courses are either full or not available for enrollment."})]}):e.jsx(l,{container:!0,spacing:3,children:D.map(r=>{const o=g(r);return e.jsx(l,{item:!0,xs:12,md:6,lg:4,children:e.jsx(u,{sx:{p:3,height:"100%",border:"1px solid #e0e0e0",borderRadius:2,boxShadow:"0 4px 12px rgba(0,0,0,0.1)",transition:"all 0.3s ease","&:hover":{boxShadow:"0 8px 24px rgba(0,0,0,0.15)",transform:"translateY(-4px)",borderColor:"primary.main"}},children:e.jsxs(c,{spacing:2,children:[e.jsxs(x,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs(x,{sx:{flex:1},children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:r.TITLE}),e.jsx(c,{direction:"row",spacing:1,flexWrap:"wrap",useFlexGap:!0,children:e.jsx(B,{label:o.label,color:o.color,size:"small"})})]}),e.jsx(Y,{size:"small",onClick:()=>R(r),sx:{color:"text.secondary","&:hover":{color:"primary.main"}},children:e.jsx(p,{icon:"eva:info-fill"})})]}),e.jsxs(x,{children:[e.jsxs(t,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:[e.jsx("strong",{children:"Location:"})," ",r.LOCATION]}),e.jsxs(t,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:[e.jsx("strong",{children:"Start Date:"})," ",i(r.STARTDATE)]}),e.jsxs(t,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:[e.jsx("strong",{children:"End Date:"})," ",i(r.ENDDATE)]}),r.INSTRUCTOR_NAMES&&e.jsxs(t,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:[e.jsx("strong",{children:"Instructor:"})," ",r.INSTRUCTOR_NAMES]})]}),e.jsxs(c,{direction:"row",spacing:1,children:[e.jsx(j,{size:"small",variant:"contained",startIcon:e.jsx(p,{icon:"eva:plus-fill"}),onClick:()=>ne(r),children:"Enroll"}),e.jsx(j,{size:"small",variant:"outlined",startIcon:e.jsx(p,{icon:"eva:info-fill"}),onClick:()=>R(r),children:"Details"})]})]})})},r.COURSEID)})})}),e.jsxs($,{open:ee,onClose:_,maxWidth:"sm",fullWidth:!0,children:[e.jsx(q,{children:"Enroll in Course"}),e.jsx(H,{children:d&&e.jsxs(x,{sx:{pt:2},children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:d.TITLE}),e.jsxs(t,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:[e.jsx("strong",{children:"Location:"})," ",d.LOCATION]}),e.jsxs(t,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:[e.jsx("strong",{children:"Duration:"})," ",i(d.STARTDATE)," - ",i(d.ENDDATE)]}),d.INSTRUCTOR_NAMES&&e.jsxs(t,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:[e.jsx("strong",{children:"Instructor:"})," ",d.INSTRUCTOR_NAMES]}),e.jsx(ce,{severity:"info",sx:{mt:2},children:"You will be enrolled as an active student in this course."})]})}),e.jsxs(K,{children:[e.jsx(j,{onClick:_,disabled:T,children:"Cancel"}),e.jsx(j,{onClick:re,variant:"contained",disabled:T,children:T?"Enrolling...":"Enroll"})]})]}),e.jsxs($,{open:te,onClose:k,maxWidth:"md",fullWidth:!0,children:[e.jsx(q,{children:"Course Information"}),e.jsx(H,{children:n&&e.jsxs(x,{sx:{pt:2},children:[e.jsx(t,{variant:"h5",gutterBottom:!0,color:"primary",children:n.TITLE}),e.jsx(de,{sx:{my:2}}),e.jsxs(l,{container:!0,spacing:3,children:[e.jsxs(l,{item:!0,xs:12,md:6,children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Course Details"}),e.jsxs(c,{spacing:1,children:[e.jsxs(t,{variant:"body2",children:[e.jsx("strong",{children:"Course ID:"})," ",n.COURSEID]}),e.jsxs(t,{variant:"body2",children:[e.jsx("strong",{children:"Location:"})," ",n.LOCATION]}),e.jsxs(t,{variant:"body2",children:[e.jsx("strong",{children:"Start Date:"})," ",i(n.STARTDATE)]}),e.jsxs(t,{variant:"body2",children:[e.jsx("strong",{children:"End Date:"})," ",i(n.ENDDATE)]}),e.jsxs(t,{variant:"body2",children:[e.jsx("strong",{children:"Status:"})," ",g(n).label]})]})]}),e.jsxs(l,{item:!0,xs:12,md:6,children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Instructor Information"}),e.jsx(c,{spacing:1,children:n.INSTRUCTOR_NAMES?e.jsxs(e.Fragment,{children:[e.jsxs(t,{variant:"body2",children:[e.jsx("strong",{children:"Name:"})," ",n.INSTRUCTOR_NAMES]}),e.jsxs(t,{variant:"body2",children:[e.jsx("strong",{children:"Email:"})," ",n.INSTRUCTOR_EMAIL||"Contact admin for email"]}),e.jsxs(t,{variant:"body2",children:[e.jsx("strong",{children:"Contact:"})," ",n.INSTRUCTOR_PHONE||"Contact admin for phone"]})]}):e.jsx(t,{variant:"body2",color:"text.secondary",children:"Instructor information not available"})})]}),n.enrollment&&e.jsxs(l,{item:!0,xs:12,md:6,children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Enrollment Information"}),e.jsxs(c,{spacing:1,children:[e.jsxs(t,{variant:"body2",children:[e.jsx("strong",{children:"Enrollment Date:"})," ",i(n.enrollment.ENROLL_DATE)]}),e.jsxs(t,{variant:"body2",children:[e.jsx("strong",{children:"Enrollment Status:"})," ",G(n.enrollment).label]}),n.enrollment.FINAL_GRADE&&e.jsxs(t,{variant:"body2",children:[e.jsx("strong",{children:"Final Grade:"})," ",n.enrollment.FINAL_GRADE,"%"]})]})]}),n.DESCRIPTION&&e.jsxs(l,{item:!0,xs:12,md:6,children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Course Description"}),e.jsx(t,{variant:"body2",color:"text.secondary",children:n.DESCRIPTION})]}),e.jsxs(l,{item:!0,xs:12,md:6,children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Additional Information"}),e.jsxs(c,{spacing:1,children:[e.jsxs(t,{variant:"body2",children:[e.jsx("strong",{children:"Maximum Capacity:"})," ",n.MAX_CAPACITY||"Not specified"]}),e.jsxs(t,{variant:"body2",children:[e.jsx("strong",{children:"Credits:"})," ",n.CREDITS||"Not specified"]}),e.jsxs(t,{variant:"body2",children:[e.jsx("strong",{children:"Prerequisites:"})," ",n.PREREQUISITES||"None"]})]})]})]})]})}),e.jsx(K,{children:e.jsx(j,{onClick:k,children:"Close"})})]})]})]})}export{Ce as default};
