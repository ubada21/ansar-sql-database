import{z as k,E as W,r as h,J as A,K as v,j as e,e as $,w as T,p as G,k as x,T as n,a9 as M,a5 as u,B as m,aO as I}from"./index-FMbyiGBg.js";import{C as H}from"./custom-breadcrumbs-BYE_vmd6.js";import{G as c}from"./Grid-D0Xua7tw.js";import{T as J}from"./TableContainer-DFE7AUh4.js";import{b as K,d as Y,T as R,a as l,c as q}from"./TableHead-CZEiNHrS.js";import{S}from"./Stack-C1li3Gzt.js";const w={title:`My Grades | Student Dashboard - ${$.appName}`};function ne(){const L=k(),{authenticated:j,user:a}=W(),[d,B]=h.useState([]),[N,D]=h.useState(!0),f=h.useCallback(async()=>{if(a!=null&&a.UID)try{D(!0);const s=(await A.get(v.courses.list)).data.courses||[],r=[];for(const o of s)try{const E=((await A.get(v.courses.students(o.COURSEID))).data.students||[]).find(z=>z.UID===a.UID);E&&r.push({...o,enrollment:E})}catch(i){console.error(`Error fetching enrollment for course ${o.COURSEID}:`,i)}B(r)}catch(t){console.error("Error fetching enrolled courses:",t)}finally{D(!1)}},[a==null?void 0:a.UID]);if(h.useEffect(()=>{j&&(a!=null&&a.UID)&&f()},[j,a==null?void 0:a.UID,f]),!j)return L.push("/login"),null;const y=t=>{const s=new Date,r=new Date(t.STARTDATE),o=new Date(t.ENDDATE);return r>s?{label:"Upcoming",color:"info"}:r<=s&&o>=s?{label:"Ongoing",color:"success"}:{label:"Completed",color:"default"}},b=t=>t?t>=90?"success":t>=80?"primary":t>=70?"warning":"error":"default",C=t=>t?t>=90?"A":t>=80?"B":t>=70?"C":t>=60?"D":"F":"N/A",g=t=>new Date(t).toLocaleDateString(),O=()=>{const t=d.filter(r=>r.enrollment.FINAL_GRADE);return t.length===0?0:(t.reduce((r,o)=>r+o.enrollment.FINAL_GRADE,0)/t.length).toFixed(2)},F=()=>d.filter(t=>new Date(t.ENDDATE)<new Date),U=()=>d.filter(t=>{const s=new Date,r=new Date(t.STARTDATE),o=new Date(t.ENDDATE);return r<=s&&o>=s});if(N)return e.jsxs(e.Fragment,{children:[e.jsx("title",{children:w.title}),e.jsx(T,{maxWidth:"xl",children:e.jsx("div",{children:"Loading your grades..."})})]});const P=O(),p=F(),_=U();return e.jsxs(e.Fragment,{children:[e.jsx("title",{children:w.title}),e.jsxs(T,{maxWidth:"xl",children:[e.jsx(H,{heading:"My Grades",links:[{name:"Dashboard",href:G.dashboard.root},{name:"Student",href:G.dashboard.student.courses},{name:"My Grades"}],sx:{mb:{xs:3,md:5}}}),d.length===0?e.jsxs(x,{sx:{p:4,textAlign:"center"},children:[e.jsx(n,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"You are not enrolled in any courses yet."}),e.jsx(n,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Contact an administrator to enroll you in courses."})]}):e.jsxs(c,{container:!0,spacing:3,children:[e.jsx(c,{item:!0,xs:12,md:4,children:e.jsxs(x,{sx:{p:3,textAlign:"center"},children:[e.jsx(n,{variant:"h4",color:"primary",gutterBottom:!0,children:P}),e.jsx(n,{variant:"h6",gutterBottom:!0,children:"GPA"}),e.jsxs(n,{variant:"body2",color:"text.secondary",children:[p.length," completed courses"]})]})}),e.jsx(c,{item:!0,xs:12,md:4,children:e.jsxs(x,{sx:{p:3,textAlign:"center"},children:[e.jsx(n,{variant:"h4",color:"success.main",gutterBottom:!0,children:p.length}),e.jsx(n,{variant:"h6",gutterBottom:!0,children:"Completed Courses"}),e.jsxs(n,{variant:"body2",color:"text.secondary",children:[p.filter(t=>t.enrollment.FINAL_GRADE).length," with grades"]})]})}),e.jsx(c,{item:!0,xs:12,md:4,children:e.jsxs(x,{sx:{p:3,textAlign:"center"},children:[e.jsx(n,{variant:"h4",color:"info.main",gutterBottom:!0,children:_.length}),e.jsx(n,{variant:"h6",gutterBottom:!0,children:"Ongoing Courses"}),e.jsx(n,{variant:"body2",color:"text.secondary",children:"Currently enrolled"})]})}),e.jsx(c,{item:!0,xs:12,children:e.jsxs(x,{sx:{p:3},children:[e.jsx(n,{variant:"h6",gutterBottom:!0,children:"Course Grades"}),e.jsx(J,{component:M,variant:"outlined",children:e.jsxs(K,{children:[e.jsx(Y,{children:e.jsxs(R,{children:[e.jsx(l,{children:"Course"}),e.jsx(l,{children:"Status"}),e.jsx(l,{children:"Final Grade"}),e.jsx(l,{children:"Letter Grade"}),e.jsx(l,{children:"Enrollment Date"}),e.jsx(l,{children:"Completion Date"})]})}),e.jsx(q,{children:d.map(t=>{const s=y(t),r=t.enrollment.FINAL_GRADE,o=b(r),i=C(r);return e.jsxs(R,{children:[e.jsxs(l,{children:[e.jsx(n,{variant:"subtitle2",children:t.TITLE}),e.jsx(n,{variant:"body2",color:"text.secondary",children:t.LOCATION})]}),e.jsx(l,{children:e.jsx(u,{label:s.label,color:s.color,size:"small"})}),e.jsx(l,{children:r?e.jsxs(m,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsxs(n,{variant:"body2",children:[r,"%"]}),e.jsx(I,{variant:"determinate",value:r,color:o,sx:{width:60,height:6,borderRadius:3}})]}):e.jsx(n,{variant:"body2",color:"text.secondary",children:"Pending"})}),e.jsx(l,{children:r?e.jsx(u,{label:i,color:o,size:"small"}):e.jsx(n,{variant:"body2",color:"text.secondary",children:"N/A"})}),e.jsx(l,{children:g(t.enrollment.ENROLL_DATE)}),e.jsx(l,{children:s.label==="Completed"?g(t.ENDDATE):"Ongoing"})]},t.COURSEID)})})]})})]})}),e.jsx(c,{item:!0,xs:12,children:e.jsx(n,{variant:"h6",gutterBottom:!0,children:"Detailed Grades"})}),d.map(t=>{const s=y(t),r=t.enrollment.FINAL_GRADE,o=b(r),i=C(r);return e.jsx(c,{item:!0,xs:12,md:6,lg:4,children:e.jsx(x,{sx:{p:3,height:"100%"},children:e.jsxs(S,{spacing:2,children:[e.jsxs(m,{children:[e.jsx(n,{variant:"h6",gutterBottom:!0,children:t.TITLE}),e.jsxs(S,{direction:"row",spacing:1,flexWrap:"wrap",useFlexGap:!0,children:[e.jsx(u,{label:s.label,color:s.color,size:"small"}),r&&e.jsx(u,{label:`${r}% (${i})`,color:o,size:"small"})]})]}),e.jsxs(m,{children:[e.jsxs(n,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:[e.jsx("strong",{children:"Location:"})," ",t.LOCATION]}),e.jsxs(n,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:[e.jsx("strong",{children:"Enrolled:"})," ",g(t.enrollment.ENROLL_DATE)]}),e.jsxs(n,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:[e.jsx("strong",{children:"Status:"})," ",t.enrollment.STATUS]}),r&&e.jsxs(n,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:"Final Grade:"})," ",r,"% (",i,")"]})]}),r&&e.jsxs(m,{children:[e.jsx(n,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Grade Progress"}),e.jsx(I,{variant:"determinate",value:r,color:o,sx:{height:8,borderRadius:4}})]})]})})},t.COURSEID)})]})]})]})}export{ne as default};
