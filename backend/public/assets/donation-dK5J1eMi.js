import{z as $,E as q,r as T,j as e,e as U,w as G,p as E,d as h,I as S,B as M,k as O,T as r,A as k,J as H,K,N as Q,G as _,O as J,D as P,Q as X,V as B,W as w,X as Y,Y as R,Z}from"./index-B-O2wvL4.js";import{u as ee,a as ne,o as oe,s as d,n as te}from"./zod-DxVdrIxN.js";import{C as se}from"./custom-breadcrumbs-C2AuKEDp.js";import{S as m}from"./Stack-BjYbPdpy.js";import{D as ae,a as re}from"./DialogTitle-w8z7uk1s.js";import{T as u}from"./TextField-BfDbW8wr.js";const L={title:`Donate | ${U.appName}`},ie=oe({email:d().email("Please enter a valid email address"),firstName:d().min(1,"First name is required"),lastName:d().min(1,"Last name is required"),amount:te().min(1,"Amount must be at least $1"),method:d().min(1,"Please select a payment method"),address:d().optional(),city:d().optional(),province:d().optional(),postalCode:d().optional(),notes:d().optional()}),W=["AB","BC","MB","NB","NL","NS","NT","NU","ON","PE","QC","SK","YT"],F=["Credit Card","Debit Card","Bank Transfer","PayPal","Cash","Check"];function xe(){const s=$(),{authenticated:c,user:n}=q(),[o,p]=T.useState(!1),[g,j]=T.useState(!1),[t,I]=T.useState(""),{register:N,handleSubmit:A,setValue:i,watch:D,formState:{errors:y,isSubmitting:f}}=ee({resolver:ne(ie),defaultValues:{email:"",firstName:"",lastName:"",amount:"",method:"",address:"",city:"",province:"",postalCode:"",notes:""}}),b=D("province");T.useEffect(()=>{c&&n&&(i("email",n.EMAIL||""),i("firstName",n.FIRSTNAME||""),i("lastName",n.LASTNAME||""),i("address",n.ADDRESS||""),i("city",n.CITY||""),i("province",n.PROVINCE||""),i("postalCode",n.POSTALCODE||""))},[c,n,i]);const v=async a=>{p(!0),I("");try{const l=`RCP-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,z={EMAIL:a.email||(n==null?void 0:n.EMAIL),FIRSTNAME:a.firstName||(n==null?void 0:n.FIRSTNAME),LASTNAME:a.lastName||(n==null?void 0:n.LASTNAME),AMOUNT:a.amount,METHOD:a.method,ADDRESS:a.address||(n==null?void 0:n.ADDRESS)||null,CITY:a.city||(n==null?void 0:n.CITY)||null,PROVINCE:a.province||(n==null?void 0:n.PROVINCE)||null,POSTALCODE:a.postalCode||(n==null?void 0:n.POSTALCODE)||null,NOTES:a.notes||null,RECEIPT_NUMBER:l,DONOR_ID:c&&n?n.UID:null};await _.post(J.transactions.create,z),j(!0),p(!1)}catch(l){console.error("Error submitting donation:",l),I("There was an error processing your donation. Please try again."),p(!1)}},x=()=>{c?s.push(E.dashboard.root):s.push("/")},C=()=>{j(!1),i("amount",""),i("method",""),i("notes","")};return c?e.jsxs(e.Fragment,{children:[e.jsx("title",{children:L.title}),e.jsxs(G,{maxWidth:"lg",children:[e.jsx(se,{heading:"Support Our Mission",links:[{name:"Dashboard",href:E.dashboard.root},{name:"Donate"}],action:e.jsx(h,{variant:"outlined",onClick:x,startIcon:e.jsx(S,{icon:"eva:arrow-back-fill"}),children:"Back to Dashboard"}),sx:{mb:{xs:3,md:5}}}),g?e.jsx(M,{sx:{py:4},children:e.jsxs(O,{sx:{p:4,textAlign:"center"},children:[e.jsx(r,{variant:"h4",color:"success.main",gutterBottom:!0,children:"Thank You for Your Donation!"}),e.jsx(r,{variant:"body1",color:"text.secondary",sx:{mb:3},children:"Your generous contribution will help support our educational programs and community initiatives."}),e.jsx(k,{severity:"success",sx:{mb:3},children:"Your donation has been successfully processed. You will receive a confirmation email shortly."}),e.jsxs(m,{direction:"row",spacing:2,justifyContent:"center",children:[e.jsx(h,{variant:"contained",onClick:C,children:"Make Another Donation"}),e.jsx(h,{variant:"outlined",onClick:x,startIcon:e.jsx(S,{icon:"eva:arrow-back-fill"}),children:"Back to Dashboard"})]})]})}):e.jsx(V,{register:N,handleSubmit:A,onSubmit:v,errors:y,loading:o,isSubmitting:f,error:t,authenticated:c,router:s,provinces:W,paymentMethods:F,watchedProvince:b})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("title",{children:L.title}),e.jsx(H,{sx:{color:"#fff",zIndex:a=>a.zIndex.drawer+1,backgroundColor:"rgba(0, 0, 0, 0.8)"},open:!0,children:e.jsxs(K,{open:!0,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{borderRadius:2,maxHeight:"90vh",overflow:"auto"}},children:[e.jsx(ae,{sx:{pb:1},children:e.jsxs(M,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsx(r,{variant:"h5",component:"div",children:"Support Our Mission"}),e.jsx(Q,{onClick:x,sx:{color:"text.secondary"},children:e.jsx(S,{icon:"eva:close-fill"})})]})}),e.jsx(re,{sx:{pt:2},children:g?e.jsxs(M,{sx:{py:2,textAlign:"center"},children:[e.jsx(r,{variant:"h5",color:"success.main",gutterBottom:!0,children:"Thank You for Your Donation!"}),e.jsx(r,{variant:"body1",color:"text.secondary",sx:{mb:3},children:"Your generous contribution will help support our educational programs and community initiatives."}),e.jsx(k,{severity:"success",sx:{mb:3},children:"Your donation has been successfully processed. You will receive a confirmation email shortly."}),e.jsxs(m,{direction:"row",spacing:2,justifyContent:"center",children:[e.jsx(h,{variant:"contained",onClick:C,children:"Make Another Donation"}),e.jsx(h,{variant:"outlined",onClick:x,children:"Close"})]})]}):e.jsx(V,{register:N,handleSubmit:A,onSubmit:v,errors:y,loading:o,isSubmitting:f,error:t,authenticated:c,router:s,provinces:W,paymentMethods:F,watchedProvince:b})})]})})]})}function V({register:s,handleSubmit:c,onSubmit:n,errors:o,loading:p,isSubmitting:g,error:j,authenticated:t,router:I,provinces:N,paymentMethods:A,watchedProvince:i}){var D,y,f,b,v,x,C,a;return e.jsxs(M,{children:[e.jsx(r,{variant:"h6",textAlign:"center",color:"text.secondary",sx:{mb:4},children:"Your donation helps us provide quality Islamic education and community services"}),e.jsxs(O,{sx:{p:4},children:[e.jsx(r,{variant:"h5",gutterBottom:!0,children:"Make a Donation"}),e.jsx(r,{variant:"body2",color:"text.secondary",sx:{mb:4},children:t?"Thank you for being a registered user. Your information has been pre-filled for your convenience.":"Please provide your information below. You can also create an account to save your details for future donations."}),j&&e.jsx(k,{severity:"error",sx:{mb:3},children:j}),e.jsx("form",{onSubmit:c(n),children:e.jsxs(m,{spacing:3,children:[e.jsx(r,{variant:"h6",gutterBottom:!0,children:"Personal Information"}),e.jsxs(m,{direction:{xs:"column",sm:"row"},spacing:2,children:[e.jsx(u,{fullWidth:!0,label:"First Name",...s("firstName"),error:!!o.firstName,helperText:(D=o.firstName)==null?void 0:D.message,InputProps:{readOnly:t},sx:{"& .MuiInputBase-input.Mui-readOnly":{backgroundColor:t?"action.hover":"transparent"}}}),e.jsx(u,{fullWidth:!0,label:"Last Name",...s("lastName"),error:!!o.lastName,helperText:(y=o.lastName)==null?void 0:y.message,InputProps:{readOnly:t},sx:{"& .MuiInputBase-input.Mui-readOnly":{backgroundColor:t?"action.hover":"transparent"}}})]}),e.jsx(u,{fullWidth:!0,label:"Email Address",type:"email",...s("email"),error:!!o.email,helperText:(f=o.email)==null?void 0:f.message,InputProps:{readOnly:t},sx:{"& .MuiInputBase-input.Mui-readOnly":{backgroundColor:t?"action.hover":"transparent"}}}),e.jsx(P,{}),e.jsx(r,{variant:"h6",gutterBottom:!0,children:"Donation Details"}),e.jsxs(m,{direction:{xs:"column",sm:"row"},spacing:2,children:[e.jsx(u,{fullWidth:!0,label:"Amount",type:"number",InputProps:{startAdornment:e.jsx(X,{position:"start",children:"$"})},...s("amount",{valueAsNumber:!0}),error:!!o.amount,helperText:(b=o.amount)==null?void 0:b.message}),e.jsxs(B,{fullWidth:!0,error:!!o.method,children:[e.jsx(w,{children:"Payment Method"}),e.jsx(Y,{label:"Payment Method",...s("method"),error:!!o.method,children:A.map(l=>e.jsx(R,{value:l,children:l},l))})]})]}),e.jsx(u,{fullWidth:!0,label:"Notes (Optional)",multiline:!0,rows:3,placeholder:"Any additional comments or special instructions...",...s("notes"),error:!!o.notes,helperText:(v=o.notes)==null?void 0:v.message}),e.jsx(P,{}),e.jsx(r,{variant:"h6",gutterBottom:!0,children:"Address Information (Optional)"}),e.jsx(u,{fullWidth:!0,label:"Address",...s("address"),error:!!o.address,helperText:(x=o.address)==null?void 0:x.message,InputProps:{readOnly:t},sx:{"& .MuiInputBase-input.Mui-readOnly":{backgroundColor:t?"action.hover":"transparent"}}}),e.jsxs(m,{direction:{xs:"column",sm:"row"},spacing:2,children:[e.jsx(u,{fullWidth:!0,label:"City",...s("city"),error:!!o.city,helperText:(C=o.city)==null?void 0:C.message,InputProps:{readOnly:t},sx:{"& .MuiInputBase-input.Mui-readOnly":{backgroundColor:t?"action.hover":"transparent"}}}),e.jsxs(B,{fullWidth:!0,error:!!o.province,children:[e.jsx(w,{children:"Province"}),e.jsx(Y,{label:"Province",...s("province"),error:!!o.province,disabled:t,value:i||"",children:N.map(l=>e.jsx(R,{value:l,children:l},l))})]})]}),e.jsx(u,{fullWidth:!0,label:"Postal Code",...s("postalCode"),error:!!o.postalCode,helperText:(a=o.postalCode)==null?void 0:a.message,InputProps:{readOnly:t},sx:{"& .MuiInputBase-input.Mui-readOnly":{backgroundColor:t?"action.hover":"transparent"}}}),e.jsx(P,{}),e.jsxs(m,{direction:"row",spacing:2,justifyContent:"flex-end",children:[!t&&e.jsx(h,{variant:"outlined",onClick:()=>I.push("/login"),children:"Sign In"}),e.jsx(h,{type:"submit",variant:"contained",size:"large",disabled:p||g,startIcon:p?e.jsx(Z,{size:20}):null,children:p?"Processing...":"Complete Donation"})]})]})})]}),e.jsxs(O,{sx:{p:4,mt:4},children:[e.jsx(r,{variant:"h6",gutterBottom:!0,children:"About Your Donation"}),e.jsxs(m,{spacing:2,children:[e.jsx(r,{variant:"body2",color:"text.secondary",children:"• All donations are tax-deductible and you will receive a receipt for your records"}),e.jsx(r,{variant:"body2",color:"text.secondary",children:"• Your information is kept secure and will only be used for donation processing"}),e.jsx(r,{variant:"body2",color:"text.secondary",children:"• For questions about your donation, please contact us at donations@example.com"})]})]})]})}export{xe as default};
