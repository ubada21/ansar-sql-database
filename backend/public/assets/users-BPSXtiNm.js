import{r as d,G as S,O,j as e,K as se,T as y,A as ie,B as D,d as V,a5 as ce,a3 as Y,n as Re,b as Ie,R as oe,a6 as Q,a7 as le,N as K,I as T,a8 as de,a9 as me,Y as q,V as ue,W as xe,X as he,D as ne,Q as Ne,aa as _,ab as Te,w as X,p as J,k as z,x as Ae,ac as Pe,U as Le,y as Fe,ad as Ue,e as Oe}from"./index-DQDqTxBb.js";import{A as pe,F as ke,a as Z,c as ee}from"./filters-result-Ct5WnSeV.js";import{u as ge,a as fe,o as je,C as re,b as be,s as f,c as Ce}from"./zod-Cpv4Fv3X.js";import{t as P}from"./index-CudtMX4b.js";import{F as ye,a as b}from"./form-provider-DBevHCiP.js";import{a as te,D as Ee}from"./DialogTitle-ymJkIh09.js";import{T as ae}from"./TextField-CsdIJsqM.js";import{D as De}from"./DialogActions-D7haeB3N.js";import{C as ve,a as we,u as Me,g as Be,r as $e,T as qe,b as Ve,c as We,e as ze,d as Ge,f as He}from"./table-pagination-custom-DNPwKJqb.js";import{C as Qe}from"./custom-breadcrumbs-DsoBZfRF.js";import{T as Ye,a as $,b as Ke,c as _e}from"./TableHead-DvJP4bZj.js";import{S as Xe}from"./Stack-nn9g4P4i.js";import{G}from"./Grid-CFl9eb3d.js";import"./TableSortLabel-Dulv0lzS.js";const Je=je({firstName:f().min(1,{message:"First Name is required!"}),middleName:f().optional(),lastName:f().min(1,{message:"Last Name is required!"}),email:f().min(1,{message:"Email is required!"}).email({message:"Email must be a valid email address!"}),phoneNumber:f().optional(),province:f().optional(),city:f().optional(),address:f().optional(),postalCode:f().optional(),DOB:f().optional(),roles:be(Ce()).optional()});function Ze({currentUser:s,open:i,onClose:x}){const[c,u]=d.useState([]),[m,h]=d.useState(!1),j=d.useMemo(()=>({firstName:"",middleName:"",lastName:"",email:"",phoneNumber:"",address:"",province:"",city:"",postalCode:"",DOB:"",roles:[]}),[]),n=d.useCallback(t=>t?(console.log(t.DOB),{firstName:t.FIRSTNAME||"",middleName:t.MIDDLENAME||"",lastName:t.LASTNAME||"",email:t.EMAIL||"",phoneNumber:t.PHONENUMBER||"",address:t.ADDRESS||"",province:t.PROVINCE||"",city:t.CITY||"",postalCode:t.POSTALCODE||"",DOB:t.DOB?new Date(t.DOB).toISOString().split("T")[0]:"",roles:t.roles||[]}):j,[j]),l=ge({mode:"onSubmit",resolver:fe(Je),defaultValues:j}),{reset:p,handleSubmit:E,setValue:A,formState:{isSubmitting:L,isDirty:R}}=l;d.useEffect(()=>{i||h(!1)},[i]),d.useEffect(()=>{const t=async()=>{try{const o=await S.get(O.roles.list);u(o.data.roles||[])}catch(o){console.error("Error fetching roles:",o),P.error("Failed to load roles")}};i&&c.length===0&&t()},[i,c.length]),d.useEffect(()=>{i&&(s!=null&&s.UID)?(async()=>{h(!0);try{const[,o]=await Promise.all([S.get(O.users.details(s.UID)),S.get(O.users.roles(s.UID))]),a={...s,roles:o.data.roles||[]},w=n(a);p(w)}catch(o){console.error("Error fetching user details:",o);const a=n(s);p(a)}finally{h(!1)}})():i&&h(!1)},[i,s,n,p]);const g=E(async t=>{try{const{roles:o,...a}=t,w={FIRSTNAME:a.firstName,MIDDLENAME:a.middleName,LASTNAME:a.lastName,EMAIL:a.email,PHONENUMBER:a.phoneNumber,ADDRESS:a.address,PROVINCE:a.province,CITY:a.city,POSTALCODE:a.postalCode,DOB:a.DOB};if(await S.put(O.users.details(s.UID),w),o&&Array.isArray(o)){const F=o.map(v=>v.ROLEID||v.id).filter(Boolean),N=((await S.get(O.users.roles(s.UID))).data.roles||[]).map(v=>v.ROLEID);for(const v of N)if(!F.includes(v))try{await S.delete(O.users.roles(s.UID)+`/${v}`)}catch{}for(const v of F)if(!N.includes(v))try{await S.post(O.users.roles(s.UID),{ROLEID:v})}catch{}}P.success("User updated successfully!"),x(),p(),window.location.reload()}catch(o){console.error("Error updating user:",o),P.error("Failed to update user!")}});return m?e.jsx(se,{fullWidth:!0,maxWidth:"md",open:i,onClose:x,PaperProps:{sx:{borderRadius:2}},children:e.jsx(te,{sx:{display:"flex",justifyContent:"center",py:4},children:e.jsx(y,{children:"Loading user data..."})})}):e.jsx(se,{fullWidth:!0,maxWidth:!1,open:i,onClose:x,slotProps:{backdrop:{invisible:!0}},PaperProps:{sx:{maxWidth:720}},children:e.jsxs(ye,{methods:l,onSubmit:g,children:[e.jsx(Ee,{children:"Quick Update"}),e.jsxs(te,{dividers:!0,sx:{pt:3},children:[e.jsx(ie,{severity:"info",sx:{mb:3},children:"Update the information below and we will update you when changes are made."}),e.jsxs(D,{rowGap:3,columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)"},children:[e.jsx(b.Text,{name:"firstName",label:"First Name"}),e.jsx(b.Text,{name:"middleName",label:"Middle Name"}),e.jsx(b.Text,{name:"lastName",label:"Last Name"}),e.jsx(b.Text,{name:"DOB",label:"Date of Birth",type:"date"}),e.jsx(b.Text,{name:"email",label:"Email Address"}),e.jsx(b.Text,{name:"phoneNumber",label:"Phone Number"}),e.jsx(b.Text,{name:"address",label:"Address"}),e.jsx(b.Text,{name:"province",label:"Province"}),e.jsx(b.Text,{name:"city",label:"City"}),e.jsx(b.Text,{name:"postalCode",label:"Postal Code"})]}),e.jsxs(D,{sx:{mt:3},children:[e.jsx(y,{variant:"h6",sx:{mb:2},children:"Roles"}),e.jsx(y,{variant:"body2",sx:{color:"text.secondary",mb:2},children:"Select one or more roles for this user"}),e.jsx(re,{name:"roles",control:l.control,render:({field:t,fieldState:{error:o}})=>e.jsx(pe,{...t,multiple:!0,options:c,getOptionLabel:a=>a.ROLENAME,isOptionEqualToValue:(a,w)=>a.ROLEID===w.ROLEID,value:t.value||[],onChange:(a,w)=>{t.onChange(w),A("roles",w,{shouldValidate:!0})},renderInput:a=>e.jsx(ae,{...a,label:"Roles",placeholder:"Select roles...",error:!!o,helperText:o==null?void 0:o.message}),slotProps:{chip:{size:"small",variant:"soft"}}})})]})]}),e.jsxs(De,{sx:{px:3,pb:3},children:[e.jsx(V,{variant:"outlined",color:"inherit",onClick:x,children:"Cancel"}),e.jsx(V,{type:"submit",variant:"contained",loading:L,disabled:!R,children:R?"Save changes":"No changes made"})]})]})})}function es({row:s,userRoles:i,selected:x,editHref:c,onSelectRow:u,onDeleteRow:m}){const h=ce(),j=Y(),n=Y(),l=()=>e.jsx(Ze,{currentUser:s,open:n.value,onClose:n.onFalse}),p=()=>e.jsx(de,{open:h.open,anchorEl:h.anchorEl,onClose:h.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(me,{children:[e.jsx("li",{children:e.jsxs(q,{component:oe,href:c,onClick:()=>h.onClose(),children:[e.jsx(T,{icon:"solar:pen-bold"}),"Edit"]})}),e.jsxs(q,{onClick:()=>{j.onTrue(),h.onClose()},sx:{color:"error.main"},children:[e.jsx(T,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})]})}),E=()=>e.jsx(we,{open:j.value,onClose:j.onFalse,title:"Delete",content:"Are you sure want to delete?",action:e.jsx(V,{variant:"contained",color:"error",onClick:m,children:"Delete"})});return e.jsxs(e.Fragment,{children:[e.jsxs(Ye,{hover:!0,selected:x,"aria-checked":x,tabIndex:-1,children:[e.jsx($,{padding:"checkbox",children:e.jsx(ve,{checked:x,onClick:u,slotProps:{input:{id:`${s.UID}-checkbox`,"aria-label":`${s.UID} checkbox`}}})}),e.jsx($,{children:e.jsxs(D,{sx:{gap:2,display:"flex",alignItems:"center"},children:[e.jsx(Re,{alt:`${s.FIRSTNAME} ${s.LASTNAME}`}),e.jsxs(Xe,{sx:{typography:"body2",flex:"1 1 auto",alignItems:"flex-start"},children:[e.jsxs(Ie,{component:oe,href:c,color:"inherit",sx:{cursor:"pointer"},children:[s.FIRSTNAME," ",s.LASTNAME]}),e.jsxs(D,{component:"span",sx:{color:"text.disabled"},children:["ID: ",s.UID]})]})]})}),e.jsx($,{sx:{whiteSpace:"nowrap"},children:s.EMAIL}),e.jsx($,{sx:{whiteSpace:"nowrap"},children:s.PHONENUMBER||"N/A"}),e.jsx($,{sx:{whiteSpace:"nowrap"},children:i.length>0?e.jsx(D,{sx:{display:"flex",flexDirection:"column",gap:.5},children:i.map(A=>e.jsx(Q,{variant:"soft",color:A.ROLENAME==="admin"?"primary":"default",sx:{fontSize:"0.75rem"},children:A.ROLENAME},A.ROLEID))}):e.jsx(Q,{variant:"soft",color:"default",sx:{fontSize:"0.75rem"},children:"No roles"})}),e.jsx($,{children:e.jsx(Q,{variant:"soft",color:"success",children:"Active"})}),e.jsx($,{children:e.jsxs(D,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(le,{title:"Quick edit",placement:"top",arrow:!0,children:e.jsx(K,{color:n.value?"inherit":"default",onClick:n.onTrue,children:e.jsx(T,{icon:"solar:pen-bold"})})}),e.jsx(le,{title:"Delete",children:e.jsx(K,{color:"error",onClick:j.onTrue,children:e.jsx(T,{icon:"solar:trash-bin-trash-bold"})})})]})})]}),l(),p(),E()]})}const ss=["AB","BC","MB","NB","NL","NS","NT","NU","ON","PE","QC","SK","YT"],rs=je({firstName:f().min(1,{message:"First name is required!"}),lastName:f().min(1,{message:"Last name is required!"}),email:f().min(1,{message:"Email is required!"}).email({message:"Email must be a valid email address!"}),phoneNumber:f().min(1,{message:"Phone number is required!"}),address:f().min(1,{message:"Address is required!"}),city:f().min(1,{message:"City is required!"}),province:f().min(1,{message:"Province is required!"}),postalCode:f().min(1,{message:"Postal code is required!"}),password:f().min(8,{message:"Password must be at least 8 characters!"}),confirmPassword:f().min(1,{message:"Please confirm your password!"}),roles:be(Ce()).min(1,{message:"At least one role is required!"})}).refine(s=>s.password===s.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]});function ts({open:s,onClose:i,onSuccess:x}){const[c,u]=d.useState([]),[m,h]=d.useState(!1),j={firstName:"",lastName:"",email:"",phoneNumber:"",address:"",city:"",province:"",postalCode:"",password:"",confirmPassword:"",roles:[]},n=ge({mode:"onChange",resolver:fe(rs),defaultValues:j}),{reset:l,handleSubmit:p,control:E,formState:{isSubmitting:A}}=n;d.useEffect(()=>{s&&(async()=>{try{const t=await S.get(O.roles.list);t.status===200&&u(t.data.roles||[])}catch(t){console.error("Error fetching roles:",t),P.error("Failed to load roles")}})()},[s]);const L=p(async g=>{var t,o,a,w,F;try{h(!0);const I={FIRSTNAME:g.firstName,LASTNAME:g.lastName,EMAIL:g.email,PASSWORD:g.password,PHONENUMBER:g.phoneNumber,ADDRESS:g.address,CITY:g.city,PROVINCE:g.province,POSTALCODE:g.postalCode},N=g.roles.map(k=>k.ROLEID);console.log("Creating user with data:",I),console.log("Selected roles:",N),console.log("API endpoint: /register");const v=await S.post("/register",I);console.log("User creation response:",v);const U=v.data.UID;if(console.log("New user ID:",U),N.length>0){console.log("Assigning roles to user:",U);for(const k of N)try{const r=await S.post(`/users/${U}/roles/`,{UID:U,ROLEID:k});console.log(`Role ${k} assigned successfully:`,r.data)}catch(r){console.error(`Error assigning role ${k}:`,r),console.error("Role error response:",(t=r.response)==null?void 0:t.data)}}P.success("User created successfully!"),l(),i(),x&&x()}catch(I){console.error("Error creating user:",I),console.error("Error response:",I.response),console.error("Error response data:",(o=I.response)==null?void 0:o.data),console.error("Error status:",(a=I.response)==null?void 0:a.status),console.error("Error message:",I.message);const N=((F=(w=I.response)==null?void 0:w.data)==null?void 0:F.message)||"Failed to create user!";P.error(N)}finally{h(!1)}}),R=()=>{l(),i()};return e.jsx(se,{fullWidth:!0,maxWidth:"md",open:s,onClose:R,PaperProps:{sx:{borderRadius:2}},children:e.jsxs(ye,{methods:n,onSubmit:L,children:[e.jsx(Ee,{sx:{pb:2},children:e.jsxs(D,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(y,{variant:"h6",children:"Create New User"}),e.jsx(K,{onClick:R,children:e.jsx(T,{icon:"eva:close-fill"})})]})}),e.jsxs(te,{dividers:!0,sx:{pt:2},children:[e.jsx(ie,{severity:"info",sx:{mb:3},children:"Fill in the user information below. All required fields must be completed."}),e.jsxs(D,{sx:{rowGap:3,columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)"}},children:[e.jsx(b.Text,{name:"firstName",label:"First Name"}),e.jsx(b.Text,{name:"lastName",label:"Last Name"}),e.jsx(b.Text,{name:"email",label:"Email Address",type:"email"}),e.jsx(b.Text,{name:"phoneNumber",label:"Phone Number"}),e.jsx(b.Text,{name:"address",label:"Address",sx:{gridColumn:{xs:"span 1",sm:"span 2"}}}),e.jsx(b.Text,{name:"city",label:"City"}),e.jsxs(ue,{fullWidth:!0,children:[e.jsx(xe,{children:"Province"}),e.jsx(re,{name:"province",control:E,render:({field:g,fieldState:{error:t}})=>e.jsx(he,{...g,label:"Province",error:!!t,children:ss.map(o=>e.jsx(q,{value:o,children:o},o))})})]}),e.jsx(b.Text,{name:"postalCode",label:"Postal Code"}),e.jsx(ne,{sx:{gridColumn:{xs:"span 1",sm:"span 2"}}}),e.jsx(b.Text,{name:"password",label:"Password",type:"password",sx:{gridColumn:{xs:"span 1",sm:"span 2"}}}),e.jsx(b.Text,{name:"confirmPassword",label:"Confirm Password",type:"password",sx:{gridColumn:{xs:"span 1",sm:"span 2"}}}),e.jsx(ne,{sx:{gridColumn:{xs:"span 1",sm:"span 2"}}}),e.jsxs(D,{sx:{gridColumn:{xs:"span 1",sm:"span 2"}},children:[e.jsx(y,{variant:"subtitle2",sx:{mb:2},children:"Roles"}),e.jsx(re,{name:"roles",control:E,render:({field:g,fieldState:{error:t}})=>e.jsx(pe,{...g,multiple:!0,options:c,getOptionLabel:o=>o.ROLENAME,isOptionEqualToValue:(o,a)=>o.ROLEID===a.ROLEID,value:g.value||[],onChange:(o,a)=>{g.onChange(a)},renderInput:o=>e.jsx(ae,{...o,label:"Select Roles",placeholder:"Choose roles...",error:!!t,helperText:t==null?void 0:t.message}),slotProps:{chip:{size:"small",variant:"soft"}}})})]})]})]}),e.jsxs(De,{sx:{p:3},children:[e.jsx(V,{variant:"outlined",color:"inherit",onClick:R,children:"Cancel"}),e.jsx(V,{type:"submit",variant:"contained",disabled:A||m,startIcon:m?e.jsx(T,{icon:"eva:loader-outline"}):null,children:m?"Creating...":"Create User"})]})]})})}function as({filters:s,options:i,onResetPage:x}){const c=ce(),{state:u,setState:m}=s,h=d.useCallback(l=>{x(),m({name:l.target.value})},[x,m]),j=d.useCallback(l=>{const p=typeof l.target.value=="string"?l.target.value.split(","):l.target.value;x(),m({role:p})},[x,m]),n=()=>e.jsx(de,{open:c.open,anchorEl:c.anchorEl,onClose:c.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(me,{children:[e.jsxs(q,{onClick:()=>c.onClose(),children:[e.jsx(T,{icon:"solar:printer-minimalistic-bold"}),"Print"]}),e.jsxs(q,{onClick:()=>c.onClose(),children:[e.jsx(T,{icon:"solar:import-bold"}),"Import"]}),e.jsxs(q,{onClick:()=>c.onClose(),children:[e.jsx(T,{icon:"solar:export-bold"}),"Export"]})]})});return e.jsxs(e.Fragment,{children:[e.jsxs(D,{sx:{p:2.5,gap:2,display:"flex",pr:{xs:2.5,md:1},flexDirection:{xs:"column",md:"row"},alignItems:{xs:"flex-end",md:"center"}},children:[e.jsxs(ue,{sx:{flexShrink:0,width:{xs:1,md:200}},children:[e.jsx(xe,{htmlFor:"filter-role-select",children:"Role"}),e.jsx(he,{multiple:!0,label:"Role",value:u.role,onChange:j,renderValue:l=>l.map(p=>p).join(", "),inputProps:{id:"filter-role-select"},MenuProps:{PaperProps:{sx:{maxHeight:240}}},children:i.roles.map(l=>e.jsxs(q,{value:l,children:[e.jsx(ve,{disableRipple:!0,size:"small",checked:u.role.includes(l),slotProps:{input:{id:`${l}-checkbox`}}}),l]},l))})]}),e.jsxs(D,{sx:{gap:2,width:1,flexGrow:1,display:"flex",alignItems:"center"},children:[e.jsx(ae,{fullWidth:!0,value:u.name,onChange:h,placeholder:"Search...",slotProps:{input:{startAdornment:e.jsx(Ne,{position:"start",children:e.jsx(T,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}}}),e.jsx(K,{onClick:c.onOpen,children:e.jsx(T,{icon:"eva:more-vertical-fill"})})]})]}),n()]})}function os({filters:s,onResetPage:i,totalResults:x,sx:c}){const{state:u,setState:m,resetState:h}=s,j=d.useCallback(()=>{i(),m({name:""})},[i,m]),n=d.useCallback(()=>{i(),m({status:"all"})},[i,m]),l=d.useCallback(E=>{const A=u.role.filter(L=>L!==E);i(),m({role:A})},[i,m,u.role]),p=d.useCallback(()=>{i(),h()},[i,h]);return e.jsxs(ke,{totalResults:x,onReset:p,sx:c,children:[e.jsx(Z,{label:"Status:",isShow:u.status!=="all",children:e.jsx(_,{...ee,label:u.status,onDelete:n,sx:{textTransform:"capitalize"}})}),e.jsx(Z,{label:"Role:",isShow:!!u.role.length,children:u.role.map(E=>d.createElement(_,{...ee,key:E,label:E,onDelete:()=>l(E)}))}),e.jsx(Z,{label:"Keyword:",isShow:!!u.name,children:e.jsx(_,{...ee,label:u.name,onDelete:j})})]})}const ls=[{value:"all",label:"All"},...Pe],ns=[{id:"name",label:"Name"},{id:"email",label:"Email",width:220},{id:"phoneNumber",label:"Phone number",width:180},{id:"roles",label:"Roles",width:200},{id:"status",label:"Status",width:100},{id:"",width:88}];function is(){const s=Me(),i=Y(),x=Y(),[c,u]=d.useState([]),[m,h]=d.useState({}),[j,n]=d.useState(!0),[l,p]=d.useState(""),[E,A]=d.useState([]),L=Te({name:"",role:[],status:"all"}),{state:R,setState:g}=L,t=d.useCallback(async()=>{try{n(!0);const r=await S.get("/users"),C=r.data;if(r.status===200){const W=C.users||[];u(W);const M={};for(const B of W)try{const H=await S.get(`/users/${B.UID}/roles`);if(H.status===200){const Se=H.data;M[B.UID]=Se.roles||[]}else M[B.UID]=[]}catch(H){console.error(`Error fetching roles for user ${B.UID}:`,H),M[B.UID]=[]}h(M)}else p(C.message||"Failed to fetch users")}catch(r){console.error("Error fetching users:",r),p("Failed to fetch users")}finally{n(!1)}},[]),o=d.useCallback(async()=>{try{const r=await S.get("/roles");if(r.status===200){const C=r.data;A(C.roles||[])}}catch(r){console.error("Error fetching roles:",r)}},[]);d.useEffect(()=>{t(),o()},[t,o]);const a=cs({inputData:c,comparator:Be(s.order,s.orderBy),filters:R,userRoles:m}),w=$e(a,s.page,s.rowsPerPage),F=!!R.name||R.role.length>0||R.status!=="all",I=!a.length&&F||!a.length,N=d.useCallback(async r=>{try{const C=await S.delete(`/users/${r}`);if(C.status===200){const W=c.filter(B=>B.UID!==r);u(W);const M={...m};delete M[r],h(M),P.success("Delete success!"),s.onUpdatePageDeleteRow(w.length)}else{const W=C.data;P.error(W.message||"Failed to delete user")}}catch(C){console.error("Error deleting user:",C),P.error("Failed to delete user")}},[w.length,s,c,m]),v=d.useCallback(async()=>{try{for(const r of s.selected)await N(r);P.success(`${s.selected.length} users deleted successfully!`)}catch(r){console.error("Error deleting selected users:",r),P.error("Failed to delete some users")}},[s.selected,N]),U=d.useCallback((r,C)=>{s.onResetPage(),g({status:C})},[g,s]),k=()=>e.jsx(we,{open:i.value,onClose:i.onFalse,title:"Delete",content:e.jsxs(e.Fragment,{children:["Are you sure want to delete ",e.jsxs("strong",{children:[" ",s.selected.length," "]})," items?"]}),action:e.jsx(V,{variant:"contained",color:"error",onClick:()=>{v(),i.onFalse()},children:"Delete"})});return j?e.jsx(X,{children:e.jsx(D,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:400},children:e.jsx(D,{children:"Loading users..."})})}):l?e.jsx(X,{children:e.jsx(D,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:400},children:e.jsx(D,{sx:{color:"error.main"},children:l})})}):e.jsxs(e.Fragment,{children:[e.jsxs(X,{children:[e.jsx(Qe,{heading:"Users List",links:[{name:"Dashboard",href:J.dashboard.root},{name:"Users",href:J.dashboard.users},{name:"List"}],action:e.jsx(V,{variant:"contained",startIcon:e.jsx(T,{icon:"mingcute:add-line"}),onClick:x.onTrue,children:"Add user"}),sx:{mb:{xs:3,md:5}}}),e.jsxs(G,{container:!0,spacing:3,sx:{mb:3},children:[e.jsx(G,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(z,{sx:{p:3,textAlign:"center"},children:[e.jsx(y,{variant:"h4",color:"primary.main",gutterBottom:!0,children:c.length}),e.jsx(y,{variant:"h6",gutterBottom:!0,children:"Total Users"}),e.jsx(y,{variant:"body2",color:"text.secondary",children:"All registered users"})]})}),e.jsx(G,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(z,{sx:{p:3,textAlign:"center"},children:[e.jsx(y,{variant:"h4",color:"success.main",gutterBottom:!0,children:c.filter(r=>r.status==="active").length}),e.jsx(y,{variant:"h6",gutterBottom:!0,children:"Active Users"}),e.jsx(y,{variant:"body2",color:"text.secondary",children:"Currently active"})]})}),e.jsx(G,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(z,{sx:{p:3,textAlign:"center"},children:[e.jsx(y,{variant:"h4",color:"warning.main",gutterBottom:!0,children:c.filter(r=>r.status==="pending").length}),e.jsx(y,{variant:"h6",gutterBottom:!0,children:"Pending Users"}),e.jsx(y,{variant:"body2",color:"text.secondary",children:"Awaiting approval"})]})}),e.jsx(G,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(z,{sx:{p:3,textAlign:"center"},children:[e.jsx(y,{variant:"h4",color:"error.main",gutterBottom:!0,children:c.filter(r=>r.status==="banned").length}),e.jsx(y,{variant:"h6",gutterBottom:!0,children:"Banned Users"}),e.jsx(y,{variant:"body2",color:"text.secondary",children:"Suspended accounts"})]})})]}),e.jsxs(z,{children:[e.jsx(Ae,{value:R.status,onChange:U,sx:[r=>({px:{md:2.5},boxShadow:`inset 0 -2px 0 0 ${Le(r.vars.palette.grey["500Channel"],.08)}`})],children:ls.map(r=>e.jsx(Fe,{iconPosition:"end",value:r.value,label:r.label,icon:e.jsx(Q,{variant:(r.value==="all"||r.value===R.status)&&"filled"||"soft",color:r.value==="active"&&"success"||r.value==="pending"&&"warning"||r.value==="banned"&&"error"||"default",children:r.value==="all"?c.length:c.filter(C=>C.status===r.value).length})},r.value))}),e.jsx(as,{filters:L,onResetPage:s.onResetPage,options:{roles:E.map(r=>r.ROLENAME)}}),F&&e.jsx(os,{filters:L,totalResults:a.length,onResetPage:s.onResetPage,sx:{p:2.5,pt:0}}),e.jsxs(D,{sx:{position:"relative"},children:[e.jsx(qe,{dense:s.dense,numSelected:s.selected.length,rowCount:a.length,onSelectAllRows:r=>s.onSelectAllRows(r,a.map(C=>C.UID))}),e.jsx(Ue,{children:e.jsxs(Ke,{size:s.dense?"small":"medium",sx:{minWidth:960},children:[e.jsx(Ve,{order:s.order,orderBy:s.orderBy,headCells:ns,rowCount:a.length,numSelected:s.selected.length,onSort:s.onSort,onSelectAllRows:r=>s.onSelectAllRows(r,a.map(C=>C.UID))}),e.jsxs(_e,{children:[a.slice(s.page*s.rowsPerPage,s.page*s.rowsPerPage+s.rowsPerPage).map(r=>e.jsx(es,{row:r,userRoles:m[r.UID]||[],selected:s.selected.includes(r.UID),onSelectRow:()=>s.onSelectRow(r.UID),onDeleteRow:()=>N(r.UID),editHref:J.dashboard.users},r.UID)),e.jsx(We,{height:s.dense?56:76,emptyRows:ze(s.page,s.rowsPerPage,a.length)}),e.jsx(Ge,{notFound:I})]})]})})]}),e.jsx(He,{page:s.page,dense:s.dense,count:a.length,rowsPerPage:s.rowsPerPage,onPageChange:s.onChangePage,onChangeDense:s.onChangeDense,onRowsPerPageChange:s.onChangeRowsPerPage})]})]}),k(),e.jsx(ts,{open:x.value,onClose:x.onFalse,onSuccess:t})]})}function cs({inputData:s,comparator:i,filters:x,userRoles:c}){const{name:u,status:m,role:h}=x,j=s.map((n,l)=>[n,l]);return j.sort((n,l)=>{const p=i(n[0],l[0]);return p!==0?p:n[1]-l[1]}),s=j.map(n=>n[0]),u&&(s=s.filter(n=>`${n.FIRSTNAME} ${n.LASTNAME}`.toLowerCase().includes(u.toLowerCase())||n.EMAIL.toLowerCase().includes(u.toLowerCase()))),m!=="all"&&(s=s.filter(n=>n.status===m)),h.length&&(s=s.filter(n=>{const l=c[n.UID]||[];return h.some(p=>l.some(E=>E.ROLENAME===p))})),s}const ds={title:`Users | Dashboard - ${Oe.appName}`};function ws(){return e.jsxs(e.Fragment,{children:[e.jsx("title",{children:ds.title}),e.jsx(is,{})]})}export{ws as default};
