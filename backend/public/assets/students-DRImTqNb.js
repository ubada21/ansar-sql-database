import{z as B,E as M,r as h,G as p,O as y,j as e,e as F,w as A,p as b,k as l,T as s,B as u,n as L,aa as T,a7 as O,N as G,I as _}from"./index-DQDqTxBb.js";import{C as k}from"./custom-breadcrumbs-DsoBZfRF.js";import{G as d}from"./Grid-CFl9eb3d.js";import{S}from"./Stack-nn9g4P4i.js";const C={title:`My Students | Instructor Dashboard - ${F.appName}`};function Y(){const E=B(),{authenticated:g,user:r}=M(),[I,R]=h.useState([]),[x,D]=h.useState([]),[N,f]=h.useState(!0),j=h.useCallback(async()=>{if(r!=null&&r.UID)try{f(!0);const i=((await p.get(y.courses.list)).data.courses||[]).filter(n=>{const m=n.INSTRUCTOR_IDS?n.INSTRUCTOR_IDS.split(","):[],v=n.INSTRUCTOR_NAMES?n.INSTRUCTOR_NAMES.split(","):[],c=`${r.FIRSTNAME} ${r.LASTNAME}`;return m.includes(r.UID.toString())||v.includes(c)});R(i);const o=new Map;for(const n of i)try{((await p.get(y.courses.students(n.COURSEID))).data.students||[]).forEach(c=>{o.has(c.UID)||o.set(c.UID,{...c,courses:[]}),o.get(c.UID).courses.push({courseId:n.COURSEID,courseTitle:n.TITLE,enrollment:c})})}catch(m){console.error(`Error fetching students for course ${n.COURSEID}:`,m)}D(Array.from(o.values()))}catch(t){console.error("Error fetching teaching courses and students:",t)}finally{f(!1)}},[r==null?void 0:r.UID,r==null?void 0:r.FIRSTNAME,r==null?void 0:r.LASTNAME]);if(h.useEffect(()=>{g&&(r!=null&&r.UID)&&j()},[g,r==null?void 0:r.UID,j]),!g)return E.push("/login"),null;const U=t=>{switch(t==null?void 0:t.toLowerCase()){case"active":return"success";case"completed":return"primary";case"withdrawn":return"warning";case"failed":return"error";default:return"default"}},w=async(t,a)=>{if(confirm("Are you sure you want to remove this student from the course?"))try{await p.delete(y.courses.removeStudent(a,t)),j()}catch(i){console.error("Error removing student:",i),alert("Failed to remove student. Please try again.")}};return N?e.jsxs(e.Fragment,{children:[e.jsx("title",{children:C.title}),e.jsx(A,{maxWidth:"xl",children:e.jsx("div",{children:"Loading your students..."})})]}):e.jsxs(e.Fragment,{children:[e.jsx("title",{children:C.title}),e.jsxs(A,{maxWidth:"xl",children:[e.jsx(k,{heading:"My Students",links:[{name:"Dashboard",href:b.dashboard.root},{name:"Instructor",href:b.dashboard.instructor.courses},{name:"My Students"}],sx:{mb:{xs:3,md:5}}}),I.length===0?e.jsxs(l,{sx:{p:4,textAlign:"center"},children:[e.jsx(s,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"You are not assigned to teach any courses yet."}),e.jsx(s,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Contact an administrator to assign you to courses."})]}):x.length===0?e.jsxs(l,{sx:{p:4,textAlign:"center"},children:[e.jsx(s,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"No students are enrolled in your courses yet."}),e.jsx(s,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Students will appear here once they enroll in your courses."})]}):e.jsxs(e.Fragment,{children:[e.jsxs(d,{container:!0,spacing:3,sx:{mb:3},children:[e.jsx(d,{item:!0,xs:12,md:4,children:e.jsxs(l,{sx:{p:3,textAlign:"center"},children:[e.jsx(s,{variant:"h4",color:"primary",gutterBottom:!0,children:x.length}),e.jsx(s,{variant:"h6",gutterBottom:!0,children:"Total Students"}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"Across all courses"})]})}),e.jsx(d,{item:!0,xs:12,md:4,children:e.jsxs(l,{sx:{p:3,textAlign:"center"},children:[e.jsx(s,{variant:"h4",color:"success.main",gutterBottom:!0,children:I.length}),e.jsx(s,{variant:"h6",gutterBottom:!0,children:"Teaching Courses"}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"Active assignments"})]})}),e.jsx(d,{item:!0,xs:12,md:4,children:e.jsxs(l,{sx:{p:3,textAlign:"center"},children:[e.jsx(s,{variant:"h4",color:"info.main",gutterBottom:!0,children:x.filter(t=>t.courses.some(a=>a.enrollment.STATUS==="active")).length}),e.jsx(s,{variant:"h6",gutterBottom:!0,children:"Active Students"}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"Currently enrolled"})]})})]}),e.jsx(d,{container:!0,spacing:3,children:x.map(t=>{var a,i;return e.jsx(d,{item:!0,xs:12,md:6,lg:4,children:e.jsx(l,{sx:{p:3,height:"100%",border:"1px solid #e0e0e0",borderRadius:2,boxShadow:"0 4px 12px rgba(0,0,0,0.1)",transition:"all 0.3s ease","&:hover":{boxShadow:"0 8px 24px rgba(0,0,0,0.15)",transform:"translateY(-4px)",borderColor:"primary.main"}},children:e.jsxs(S,{spacing:2,children:[e.jsxs(u,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(L,{sx:{width:60,height:60,bgcolor:"primary.main"},children:e.jsxs(s,{variant:"h6",children:[(a=t.FIRSTNAME)==null?void 0:a[0],(i=t.LASTNAME)==null?void 0:i[0]]})}),e.jsxs(u,{children:[e.jsxs(s,{variant:"h6",gutterBottom:!0,children:[t.FIRSTNAME," ",t.LASTNAME]}),e.jsx(s,{variant:"body2",color:"text.secondary",children:t.EMAIL})]})]}),e.jsxs(u,{children:[e.jsxs(s,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:[e.jsx("strong",{children:"Student ID:"})," ",t.UID]}),e.jsxs(s,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:[e.jsx("strong",{children:"Enrolled Courses:"})," ",t.courses.length]})]}),e.jsxs(u,{children:[e.jsx(s,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:e.jsx("strong",{children:"Courses:"})}),e.jsx(S,{spacing:1,children:t.courses.map(o=>e.jsxs(u,{sx:{p:1,border:"1px solid",borderColor:"divider",borderRadius:1},children:[e.jsx(s,{variant:"body2",fontWeight:"medium",children:o.courseTitle}),e.jsxs(S,{direction:"row",spacing:1,sx:{mt:1},children:[e.jsx(T,{label:o.enrollment.STATUS,color:U(o.enrollment.STATUS),size:"small"}),o.enrollment.FINAL_GRADE&&e.jsx(T,{label:`${o.enrollment.FINAL_GRADE}%`,color:"primary",size:"small"}),e.jsx(O,{title:"Remove from course",children:e.jsx(G,{size:"small",color:"error",onClick:()=>w(t.UID,o.courseId),children:e.jsx(_,{icon:"eva:close-fill"})})})]})]},o.courseId))})]})]})})},t.UID)})})]})]})]})}export{Y as default};
