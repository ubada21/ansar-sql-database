import{z as Q,E as V,r as m,J as M,K as v,j as e,e as X,w,p as T,k as h,T as n,a9 as Z,B as D,a5 as ee,d as N,I as U}from"./index-FMbyiGBg.js";import{C as te}from"./custom-breadcrumbs-BYE_vmd6.js";import{G as l}from"./Grid-D0Xua7tw.js";import{T as se}from"./TableContainer-DFE7AUh4.js";import{b as re,d as oe,T as O,a as f,c as ne}from"./TableHead-CZEiNHrS.js";import{S as b}from"./Stack-C1li3Gzt.js";const B={title:`My Courses | Instructor Dashboard - ${X.appName}`};function he(){const j=Q(),{authenticated:y,user:a}=V(),[u,k]=m.useState([]),[p,W]=m.useState({}),[F,S]=m.useState(!0),E=m.useCallback(async()=>{if(a!=null&&a.UID)try{S(!0);const o=((await M.get(v.courses.list)).data.courses||[]).filter(i=>{const c=i.INSTRUCTOR_IDS?i.INSTRUCTOR_IDS.split(","):[],d=i.INSTRUCTOR_NAMES?i.INSTRUCTOR_NAMES.split(","):[],C=`${a.FIRSTNAME} ${a.LASTNAME}`;return c.includes(a.UID.toString())||d.includes(C)});k(o);const s={};for(const i of o)try{const c=await M.get(v.courses.schedule(i.COURSEID));s[i.COURSEID]=c.data.schedule||[]}catch(c){console.error(`Error fetching schedule for course ${i.COURSEID}:`,c),s[i.COURSEID]=[]}W(s)}catch(t){console.error("Error fetching teaching courses:",t)}finally{S(!1)}},[a==null?void 0:a.UID,a==null?void 0:a.FIRSTNAME,a==null?void 0:a.LASTNAME]);if(m.useEffect(()=>{y&&(a!=null&&a.UID)&&E()},[y,a==null?void 0:a.UID,E]),!y)return j.push("/login"),null;const I=t=>{const r=new Date,o=new Date(t.STARTDATE),s=new Date(t.ENDDATE);return o>r?{label:"Upcoming",color:"info"}:o<=r&&s>=r?{label:"Ongoing",color:"success"}:{label:"Completed",color:"default"}},R=t=>new Date(t).toLocaleDateString(),x=t=>{if(!t)return"TBD";const r=new Date(`2000-01-01T${t}`),o=r.getHours(),s=r.getMinutes(),i=o>=12?"PM":"AM",c=o%12||12,d=s.toString().padStart(2,"0");return`${c}:${d} ${i}`},$=t=>({Monday:"Mon",Tuesday:"Tue",Wednesday:"Wed",Thursday:"Thu",Friday:"Fri",Saturday:"Sat",Sunday:"Sun"})[t]||t,L=()=>{const t=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],r=["08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00"],o={};return t.forEach(s=>{o[s]={},r.forEach(i=>{o[s][i]=[]})}),u.forEach(s=>{(p[s.COURSEID]||[]).forEach(c=>{const d=c.WEEKDAY,C=c.START_TIME,q=c.END_TIME;r.forEach(g=>{g>=C&&g<q&&(o[d][g]||(o[d][g]=[]),o[d][g].push({course:s,scheduleItem:c}))})})}),{weekdays:t,timeSlots:r,schedule:o}},{weekdays:A,timeSlots:_,schedule:H}=L(),z=()=>u.filter(t=>new Date(t.STARTDATE)>new Date),G=()=>u.filter(t=>{const r=new Date,o=new Date(t.STARTDATE),s=new Date(t.ENDDATE);return o<=r&&s>=r}),K=()=>u.filter(t=>new Date(t.ENDDATE)<new Date);if(F)return e.jsxs(e.Fragment,{children:[e.jsx("title",{children:B.title}),e.jsx(w,{maxWidth:"xl",children:e.jsx("div",{children:"Loading your courses..."})})]});const P=z(),Y=G(),J=K();return e.jsxs(e.Fragment,{children:[e.jsx("title",{children:B.title}),e.jsxs(w,{maxWidth:"xl",children:[e.jsx(te,{heading:"My Courses",links:[{name:"Dashboard",href:T.dashboard.root},{name:"Instructor",href:T.dashboard.instructor.courses},{name:"My Courses"}],sx:{mb:{xs:3,md:5}}}),u.length===0?e.jsxs(h,{sx:{p:4,textAlign:"center"},children:[e.jsx(n,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"You are not assigned to teach any courses yet."}),e.jsx(n,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Contact an administrator to assign you to courses."})]}):e.jsxs(e.Fragment,{children:[e.jsxs(l,{container:!0,spacing:3,children:[e.jsx(l,{item:!0,xs:12,md:4,children:e.jsxs(h,{sx:{p:3,textAlign:"center"},children:[e.jsx(n,{variant:"h4",color:"warning.main",gutterBottom:!0,children:P.length}),e.jsx(n,{variant:"h6",gutterBottom:!0,children:"Upcoming Courses"}),e.jsx(n,{variant:"body2",color:"text.secondary",children:"Starting soon"})]})}),e.jsx(l,{item:!0,xs:12,md:4,children:e.jsxs(h,{sx:{p:3,textAlign:"center"},children:[e.jsx(n,{variant:"h4",color:"success.main",gutterBottom:!0,children:Y.length}),e.jsx(n,{variant:"h6",gutterBottom:!0,children:"Ongoing Courses"}),e.jsx(n,{variant:"body2",color:"text.secondary",children:"Currently teaching"})]})}),e.jsx(l,{item:!0,xs:12,md:4,children:e.jsxs(h,{sx:{p:3,textAlign:"center"},children:[e.jsx(n,{variant:"h4",color:"primary",gutterBottom:!0,children:J.length}),e.jsx(n,{variant:"h6",gutterBottom:!0,children:"Completed Courses"}),e.jsx(n,{variant:"body2",color:"text.secondary",children:"Finished teaching"})]})})]}),e.jsx(l,{container:!0,spacing:3,sx:{mt:2},children:e.jsx(l,{item:!0,xs:12,children:e.jsxs(h,{sx:{p:3},children:[e.jsx(n,{variant:"h6",gutterBottom:!0,children:"Weekly Schedule"}),e.jsx(se,{component:Z,variant:"outlined",sx:{maxHeight:600},children:e.jsxs(re,{stickyHeader:!0,sx:{"& .MuiTableCell-root":{border:"1px solid #e0e0e0",backgroundColor:"#fafafa"},"& .MuiTableHead-root .MuiTableCell-root":{backgroundColor:"#f5f5f5",fontWeight:"bold",border:"1px solid #d0d0d0"},"& .MuiTableBody-root .MuiTableRow:nth-of-type(even) .MuiTableCell-root":{backgroundColor:"#ffffff"},"& .MuiTableBody-root .MuiTableRow:nth-of-type(odd) .MuiTableCell-root":{backgroundColor:"#f9f9f9"}},children:[e.jsx(oe,{children:e.jsxs(O,{children:[e.jsx(f,{sx:{minWidth:80},children:"Time"}),A.map(t=>e.jsx(f,{sx:{minWidth:120,textAlign:"center"},children:t},t))]})}),e.jsx(ne,{children:_.map(t=>e.jsxs(O,{children:[e.jsx(f,{sx:{fontWeight:"bold",fontSize:"0.875rem"},children:x(t)}),A.map(r=>{const o=H[r][t]||[];return e.jsx(f,{sx:{p:1},children:o.map((s,i)=>{const c=I(s.course);return e.jsxs(D,{sx:{p:1,mb:.5,borderRadius:1,backgroundColor:c.color==="success"?"success.light":c.color==="info"?"info.light":"grey.100",border:`1px solid ${c.color==="success"?"success.main":c.color==="info"?"info.main":"grey.300"}`,fontSize:"0.75rem",lineHeight:1.2},children:[e.jsx(n,{variant:"caption",sx:{fontWeight:"bold",display:"block"},children:s.course.TITLE}),e.jsxs(n,{variant:"caption",sx:{display:"block"},children:[x(s.scheduleItem.START_TIME)," - ",x(s.scheduleItem.END_TIME)]}),e.jsx(n,{variant:"caption",sx:{display:"block"},children:s.course.LOCATION})]},`${s.course.COURSEID}-${i}`)})},`${r}-${t}`)})]},t))})]})})]})})}),e.jsx(l,{container:!0,spacing:3,sx:{mt:2},children:u.map(t=>{const r=I(t);return e.jsx(l,{item:!0,xs:12,md:6,lg:4,children:e.jsx(h,{sx:{p:3,height:"100%"},children:e.jsxs(b,{spacing:2,children:[e.jsxs(D,{children:[e.jsx(n,{variant:"h6",gutterBottom:!0,children:t.TITLE}),e.jsx(b,{direction:"row",spacing:1,flexWrap:"wrap",useFlexGap:!0,children:e.jsx(ee,{label:r.label,color:r.color,size:"small"})})]}),e.jsxs(D,{children:[e.jsxs(n,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:[e.jsx("strong",{children:"Location:"})," ",t.LOCATION]}),e.jsxs(n,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:[e.jsx("strong",{children:"Start Date:"})," ",R(t.STARTDATE)]}),e.jsxs(n,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:[e.jsx("strong",{children:"End Date:"})," ",R(t.ENDDATE)]}),e.jsx(n,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:e.jsx("strong",{children:"Schedule:"})}),p[t.COURSEID]&&p[t.COURSEID].length>0?p[t.COURSEID].map((o,s)=>e.jsxs(n,{variant:"body2",color:"text.secondary",sx:{pl:2},children:[$(o.WEEKDAY),": ",x(o.START_TIME)," - ",x(o.END_TIME)]},s)):e.jsx(n,{variant:"body2",color:"text.secondary",sx:{pl:2},children:"No schedule set"})]}),e.jsxs(b,{direction:"row",spacing:1,children:[e.jsx(N,{size:"small",variant:"outlined",startIcon:e.jsx(U,{icon:"eva:people-fill"}),onClick:()=>j.push(T.dashboard.instructor.students),children:"Students"}),e.jsx(N,{size:"small",variant:"outlined",startIcon:e.jsx(U,{icon:"eva:file-text-fill"}),onClick:()=>j.push(T.dashboard.instructor.grades),children:"Grades"})]})]})})},t.COURSEID)})})]})]})]})}export{he as default};
