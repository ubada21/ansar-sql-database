import{r as n,f as B,g as D,u as A,j as t,s as w,_ as E,i as W,$ as me,a0 as ge,a1 as V,h as X,a2 as fe,d as ne,z as ye,G,O as J,E as we,T as Z,e as ve,A as F,K as Le,B as le}from"./index-B-O2wvL4.js";import"./jwt-sign-up-view-yk3FNVYd.js";import{u as ee,o as ce,s as U,a as pe}from"./zod-DxVdrIxN.js";import{F as te,R as $}from"./form-provider-BL3TSD8n.js";import{S as oe}from"./Stack-BjYbPdpy.js";import{D as Ce,a as je}from"./DialogTitle-w8z7uk1s.js";import"./TextField-BfDbW8wr.js";const Y=n.createContext({}),ie=n.createContext({});function Pe(e){return B("MuiStep",e)}D("MuiStep",["root","horizontal","vertical","alternativeLabel","completed"]);const Re=e=>{const{classes:o,orientation:s,alternativeLabel:a,completed:r}=e;return W({root:["root",s,a&&"alternativeLabel",r&&"completed"]},Pe,o)},Me=w("div",{name:"MuiStep",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:s}=e;return[o.root,o[s.orientation],s.alternativeLabel&&o.alternativeLabel,s.completed&&o.completed]}})({variants:[{props:{orientation:"horizontal"},style:{paddingLeft:8,paddingRight:8}},{props:{alternativeLabel:!0},style:{flex:1,position:"relative"}}]}),Ie=n.forwardRef(function(o,s){const a=A({props:o,name:"MuiStep"}),{active:r,children:c,className:u,component:i="div",completed:p,disabled:f,expanded:d=!1,index:l,last:v,...j}=a,{activeStep:S,connector:h,alternativeLabel:L,orientation:P,nonLinear:g}=n.useContext(Y);let[x=!1,R=!1,y=!1]=[r,p,f];S===l?x=r!==void 0?r:!0:!g&&S>l?R=p!==void 0?p:!0:!g&&S<l&&(y=f!==void 0?f:!0);const N=n.useMemo(()=>({index:l,last:v,expanded:d,icon:l+1,active:x,completed:R,disabled:y}),[l,v,d,x,R,y]),b={...a,active:x,orientation:P,alternativeLabel:L,completed:R,disabled:y,expanded:d,component:i},M=Re(b),C=t.jsxs(Me,{as:i,className:E(M.root,u),ref:s,ownerState:b,...j,children:[h&&L&&l!==0?h:null,c]});return t.jsx(ie.Provider,{value:N,children:h&&!L&&l!==0?t.jsxs(n.Fragment,{children:[h,C]}):C})}),Te=me(t.jsx("path",{d:"M12 0a12 12 0 1 0 0 24 12 12 0 0 0 0-24zm-2 17l-5-5 1.4-1.4 3.6 3.6 7.6-7.6L19 8l-9 9z"})),Oe=me(t.jsx("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"}));function Ne(e){return B("MuiStepIcon",e)}const se=D("MuiStepIcon",["root","active","completed","error","text"]);var de;const ze=e=>{const{classes:o,active:s,completed:a,error:r}=e;return W({root:["root",s&&"active",a&&"completed",r&&"error"],text:["text"]},Ne,o)},ae=w(ge,{name:"MuiStepIcon",slot:"Root"})(V(({theme:e})=>({display:"block",transition:e.transitions.create("color",{duration:e.transitions.duration.shortest}),color:(e.vars||e).palette.text.disabled,[`&.${se.completed}`]:{color:(e.vars||e).palette.primary.main},[`&.${se.active}`]:{color:(e.vars||e).palette.primary.main},[`&.${se.error}`]:{color:(e.vars||e).palette.error.main}}))),$e=w("text",{name:"MuiStepIcon",slot:"Text"})(V(({theme:e})=>({fill:(e.vars||e).palette.primary.contrastText,fontSize:e.typography.caption.fontSize,fontFamily:e.typography.fontFamily}))),Ee=n.forwardRef(function(o,s){const a=A({props:o,name:"MuiStepIcon"}),{active:r=!1,className:c,completed:u=!1,error:i=!1,icon:p,...f}=a,d={...a,active:r,completed:u,error:i},l=ze(d);if(typeof p=="number"||typeof p=="string"){const v=E(c,l.root);return i?t.jsx(ae,{as:Oe,className:v,ref:s,ownerState:d,...f}):u?t.jsx(ae,{as:Te,className:v,ref:s,ownerState:d,...f}):t.jsxs(ae,{className:v,ref:s,ownerState:d,...f,children:[de||(de=t.jsx("circle",{cx:"12",cy:"12",r:"12"})),t.jsx($e,{className:l.text,x:"12",y:"12",textAnchor:"middle",dominantBaseline:"central",ownerState:d,children:p})]})}return p});function ke(e){return B("MuiStepLabel",e)}const O=D("MuiStepLabel",["root","horizontal","vertical","label","active","completed","error","disabled","iconContainer","alternativeLabel","labelContainer"]),Fe=e=>{const{classes:o,orientation:s,active:a,completed:r,error:c,disabled:u,alternativeLabel:i}=e;return W({root:["root",s,c&&"error",u&&"disabled",i&&"alternativeLabel"],label:["label",a&&"active",r&&"completed",c&&"error",u&&"disabled",i&&"alternativeLabel"],iconContainer:["iconContainer",a&&"active",r&&"completed",c&&"error",u&&"disabled",i&&"alternativeLabel"],labelContainer:["labelContainer",i&&"alternativeLabel"]},ke,o)},Ue=w("span",{name:"MuiStepLabel",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:s}=e;return[o.root,o[s.orientation]]}})({display:"flex",alignItems:"center",[`&.${O.alternativeLabel}`]:{flexDirection:"column"},[`&.${O.disabled}`]:{cursor:"default"},variants:[{props:{orientation:"vertical"},style:{textAlign:"left",padding:"8px 0"}}]}),Be=w("span",{name:"MuiStepLabel",slot:"Label"})(V(({theme:e})=>({...e.typography.body2,display:"block",transition:e.transitions.create("color",{duration:e.transitions.duration.shortest}),[`&.${O.active}`]:{color:(e.vars||e).palette.text.primary,fontWeight:500},[`&.${O.completed}`]:{color:(e.vars||e).palette.text.primary,fontWeight:500},[`&.${O.alternativeLabel}`]:{marginTop:16},[`&.${O.error}`]:{color:(e.vars||e).palette.error.main}}))),De=w("span",{name:"MuiStepLabel",slot:"IconContainer"})({flexShrink:0,display:"flex",paddingRight:8,[`&.${O.alternativeLabel}`]:{paddingRight:0}}),Ae=w("span",{name:"MuiStepLabel",slot:"LabelContainer"})(V(({theme:e})=>({width:"100%",color:(e.vars||e).palette.text.secondary,[`&.${O.alternativeLabel}`]:{textAlign:"center"}}))),xe=n.forwardRef(function(o,s){const a=A({props:o,name:"MuiStepLabel"}),{children:r,className:c,componentsProps:u={},error:i=!1,icon:p,optional:f,slots:d={},slotProps:l={},StepIconComponent:v,StepIconProps:j,...S}=a,{alternativeLabel:h,orientation:L}=n.useContext(Y),{active:P,disabled:g,completed:x,icon:R}=n.useContext(ie),y=p||R;let N=v;y&&!N&&(N=Ee);const b={...a,active:P,alternativeLabel:h,completed:x,disabled:g,error:i,orientation:L},M=Fe(b),C={slots:d,slotProps:{stepIcon:j,...u,...l}},[K,q]=X("root",{elementType:Ue,externalForwardedProps:{...C,...S},ownerState:b,ref:s,className:E(M.root,c)}),[Q,z]=X("label",{elementType:Be,externalForwardedProps:C,ownerState:b}),[H,_]=X("stepIcon",{elementType:N,externalForwardedProps:C,ownerState:b});return t.jsxs(K,{...q,children:[y||H?t.jsx(De,{className:M.iconContainer,ownerState:b,children:t.jsx(H,{completed:x,active:P,error:i,icon:y,..._})}):null,t.jsxs(Ae,{className:M.labelContainer,ownerState:b,children:[r?t.jsx(Q,{...z,className:E(M.label,z==null?void 0:z.className),children:r}):null,f]})]})});xe.muiName="StepLabel";function We(e){return B("MuiStepConnector",e)}D("MuiStepConnector",["root","horizontal","vertical","alternativeLabel","active","completed","disabled","line","lineHorizontal","lineVertical"]);const Ve=e=>{const{classes:o,orientation:s,alternativeLabel:a,active:r,completed:c,disabled:u}=e,i={root:["root",s,a&&"alternativeLabel",r&&"active",c&&"completed",u&&"disabled"],line:["line",`line${fe(s)}`]};return W(i,We,o)},qe=w("div",{name:"MuiStepConnector",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:s}=e;return[o.root,o[s.orientation],s.alternativeLabel&&o.alternativeLabel,s.completed&&o.completed]}})({flex:"1 1 auto",variants:[{props:{orientation:"vertical"},style:{marginLeft:12}},{props:{alternativeLabel:!0},style:{position:"absolute",top:12,left:"calc(-50% + 20px)",right:"calc(50% + 20px)"}}]}),He=w("span",{name:"MuiStepConnector",slot:"Line",overridesResolver:(e,o)=>{const{ownerState:s}=e;return[o.line,o[`line${fe(s.orientation)}`]]}})(V(({theme:e})=>{const o=e.palette.mode==="light"?e.palette.grey[400]:e.palette.grey[600];return{display:"block",borderColor:e.vars?e.vars.palette.StepConnector.border:o,variants:[{props:{orientation:"horizontal"},style:{borderTopStyle:"solid",borderTopWidth:1}},{props:{orientation:"vertical"},style:{borderLeftStyle:"solid",borderLeftWidth:1,minHeight:24}}]}})),_e=n.forwardRef(function(o,s){const a=A({props:o,name:"MuiStepConnector"}),{className:r,...c}=a,{alternativeLabel:u,orientation:i="horizontal"}=n.useContext(Y),{active:p,disabled:f,completed:d}=n.useContext(ie),l={...a,alternativeLabel:u,orientation:i,active:p,completed:d,disabled:f},v=Ve(l);return t.jsx(qe,{className:E(v.root,r),ref:s,ownerState:l,...c,children:t.jsx(He,{className:v.line,ownerState:l})})});function Ge(e){return B("MuiStepper",e)}D("MuiStepper",["root","horizontal","vertical","nonLinear","alternativeLabel"]);const Je=e=>{const{orientation:o,nonLinear:s,alternativeLabel:a,classes:r}=e;return W({root:["root",o,s&&"nonLinear",a&&"alternativeLabel"]},Ge,r)},Ye=w("div",{name:"MuiStepper",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:s}=e;return[o.root,o[s.orientation],s.alternativeLabel&&o.alternativeLabel,s.nonLinear&&o.nonLinear]}})({display:"flex",variants:[{props:{orientation:"horizontal"},style:{flexDirection:"row",alignItems:"center"}},{props:{orientation:"vertical"},style:{flexDirection:"column"}},{props:{alternativeLabel:!0},style:{alignItems:"flex-start"}}]}),Ke=t.jsx(_e,{}),Qe=n.forwardRef(function(o,s){const a=A({props:o,name:"MuiStepper"}),{activeStep:r=0,alternativeLabel:c=!1,children:u,className:i,component:p="div",connector:f=Ke,nonLinear:d=!1,orientation:l="horizontal",...v}=a,j={...a,nonLinear:d,alternativeLabel:c,orientation:l,component:p},S=Je(j),h=n.Children.toArray(u).filter(Boolean),L=h.map((g,x)=>n.cloneElement(g,{index:x,last:x+1===h.length,...g.props})),P=n.useMemo(()=>({activeStep:r,alternativeLabel:c,connector:f,nonLinear:d,orientation:l}),[r,c,f,d,l]);return t.jsx(Y.Provider,{value:P,children:t.jsx(Ye,{as:p,ownerState:j,className:E(S.root,i),ref:s,...v,children:L})})});let ue=!1;const Xe=()=>{ue||(console.warn(["MUI: The LoadingButton component functionality is now part of the Button component from Material UI.","","You should use `import Button from '@mui/material/Button'`","or `import { Button } from '@mui/material'`"].join(`
`)),ue=!0)},re=n.forwardRef(function(o,s){return Xe(),t.jsx(ne,{ref:s,...o})});function Ze(){const e=ye(),[o,s]=n.useState(""),[a,r]=n.useState(!1),[c,u]=n.useState(!1),[i,p]=n.useState(0),[f,d]=n.useState(""),[l,v]=n.useState(!1),[j,S]=n.useState(!1),h=ee({defaultValues:{email:"",password:""}}),L=ce({email:U().email("Please enter a valid email address")}),P=ce({email:U().email("Please enter a valid email address"),otp:U().min(6,"OTP must be 6 digits").max(6,"OTP must be 6 digits"),newPassword:U().min(8,"Password must be at least 8 characters"),confirmPassword:U()}).refine(m=>m.newPassword===m.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]}),g=ee({resolver:pe(L),defaultValues:{email:""}}),x=ee({resolver:pe(P),defaultValues:{email:"",otp:"",newPassword:"",confirmPassword:""}}),{handleSubmit:R,reset:y}=h,{handleSubmit:N,reset:b}=g,{handleSubmit:M,reset:C,formState:{errors:K}}=x,q=n.useCallback(async()=>{try{(await G.get(J.auth.check_auth)).status===200&&e.push("/dashboard")}catch(m){console.error("Auth check failed",m)}},[e]);n.useEffect(()=>{q()},[q]);const{checkUserSession:Q}=we(),z=R(async m=>{var I,k;s(""),r(!0);try{const T=await G.post(J.auth.signIn,{email:m.email,password:m.password});y(),T.status===200&&(await Q(),e.push("/dashboard"))}catch(T){console.error("Login error:",T),s(((k=(I=T.response)==null?void 0:I.data)==null?void 0:k.message)||"Login failed")}finally{r(!1)}}),H=()=>{u(!0),p(0),b(),C()},_=()=>{u(!1),p(0),b(),C()},he=N(async m=>{v(!0);try{(await G.post(J.auth.requestOtp,{email:m.email})).status===200&&(d(m.email),p(1),console.log("OTP sent successfully. Check console for OTP code."))}catch(I){console.error("OTP request error:",I),d(m.email),p(1),console.log("OTP sent successfully. Check console for OTP code.")}finally{v(!1)}}),be=M(async m=>{var I,k;S(!0);try{(await G.post(J.auth.verifyOtp,{email:f,otp:m.otp,newPassword:m.newPassword})).status===200&&p(2)}catch(T){console.error("OTP verification error:",T),s(((k=(I=T.response)==null?void 0:I.data)==null?void 0:k.message)||"Invalid OTP or password reset failed")}finally{S(!1)}}),Se=["Enter Email","Verify OTP","Success"];return t.jsxs(t.Fragment,{children:[t.jsxs(Z,{variant:"h4",gutterBottom:!0,children:["Sign in to ",ve.appName]}),t.jsx(F,{severity:"info",sx:{mb:3},children:"Use your registered email and password to sign in."}),o&&t.jsx(F,{severity:"error",sx:{mb:3},children:o}),t.jsxs(te,{methods:h,onSubmit:z,children:[t.jsxs(oe,{spacing:3,children:[t.jsx($,{name:"email",label:"Email address"}),t.jsx($,{name:"password",label:"Password",type:"password"})]}),t.jsx(re,{fullWidth:!0,size:"large",type:"submit",variant:"contained",loading:a,sx:{mt:3},children:"Sign in"}),t.jsx(ne,{fullWidth:!0,variant:"text",onClick:H,sx:{mt:1},children:"Forgot Password?"})]}),t.jsxs(Le,{open:c,onClose:_,maxWidth:"sm",fullWidth:!0,children:[t.jsx(Ce,{children:"Reset Password"}),t.jsx(je,{children:t.jsxs(le,{sx:{mt:2},children:[t.jsx(Qe,{activeStep:i,sx:{mb:3},children:Se.map(m=>t.jsx(Ie,{children:t.jsx(xe,{children:m})},m))}),i===0&&t.jsx(te,{methods:g,onSubmit:he,children:t.jsxs(oe,{spacing:3,children:[t.jsx(Z,{variant:"body2",color:"text.secondary",children:"Enter your email address to receive a one-time password (OTP)."}),t.jsx($,{name:"email",label:"Email address",type:"email",required:!0}),t.jsx(re,{fullWidth:!0,type:"submit",variant:"contained",loading:l,children:"Send OTP"})]})}),i===1&&t.jsx(te,{methods:x,onSubmit:be,children:t.jsxs(oe,{spacing:3,children:[t.jsxs(Z,{variant:"body2",color:"text.secondary",children:["Enter the OTP sent to ",f," and your new password."]}),t.jsx(F,{severity:"info",children:"Check the console for the OTP code (for development purposes)."}),t.jsx($,{name:"otp",label:"OTP Code",required:!0,inputProps:{maxLength:6}}),t.jsx($,{name:"newPassword",label:"New Password",type:"password",required:!0}),t.jsx($,{name:"confirmPassword",label:"Confirm New Password",type:"password",required:!0}),K.confirmPassword&&t.jsx(F,{severity:"error",children:"Passwords do not match"}),t.jsx(re,{fullWidth:!0,type:"submit",variant:"contained",loading:j,children:"Reset Password"})]})}),i===2&&t.jsxs(le,{sx:{textAlign:"center",py:2},children:[t.jsx(F,{severity:"success",sx:{mb:2},children:"Password reset successful! You can now sign in with your new password."}),t.jsx(ne,{variant:"contained",onClick:_,children:"Close"})]})]})})]})]})}const et={title:`Sign in | Jwt - ${ve.appName}`};function lt(){return t.jsxs(t.Fragment,{children:[t.jsx("title",{children:et.title}),t.jsx(Ze,{})]})}export{lt as default};
