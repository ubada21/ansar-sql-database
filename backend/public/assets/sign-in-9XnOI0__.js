import{r as n,f as B,g as D,u as W,j as t,s as L,_ as $,i as A,$ as me,a0 as ge,a1 as V,h as Z,a2 as fe,d as K,z as ye,G,O as Y,E as Le,T as ee,e as ve,A as U,p as we,R as Ce,K as je,B as le}from"./index-DQDqTxBb.js";import"./cookie-sign-up-view-y19UsoQ2.js";import{u as te,o as ce,s as F,a as pe}from"./zod-Cpv4Fv3X.js";import{F as oe,R as z}from"./form-provider-DBevHCiP.js";import{S as se}from"./Stack-nn9g4P4i.js";import{D as Pe,a as Re}from"./DialogTitle-ymJkIh09.js";import"./TextField-CsdIJsqM.js";const J=n.createContext({}),ie=n.createContext({});function Me(e){return B("MuiStep",e)}D("MuiStep",["root","horizontal","vertical","alternativeLabel","completed"]);const Ie=e=>{const{classes:o,orientation:s,alternativeLabel:a,completed:r}=e;return A({root:["root",s,a&&"alternativeLabel",r&&"completed"]},Me,o)},Te=L("div",{name:"MuiStep",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:s}=e;return[o.root,o[s.orientation],s.alternativeLabel&&o.alternativeLabel,s.completed&&o.completed]}})({variants:[{props:{orientation:"horizontal"},style:{paddingLeft:8,paddingRight:8}},{props:{alternativeLabel:!0},style:{flex:1,position:"relative"}}]}),Oe=n.forwardRef(function(o,s){const a=W({props:o,name:"MuiStep"}),{active:r,children:c,className:u,component:i="div",completed:p,disabled:f,expanded:d=!1,index:l,last:v,...j}=a,{activeStep:S,connector:x,alternativeLabel:w,orientation:P,nonLinear:g}=n.useContext(J);let[h=!1,R=!1,y=!1]=[r,p,f];S===l?h=r!==void 0?r:!0:!g&&S>l?R=p!==void 0?p:!0:!g&&S<l&&(y=f!==void 0?f:!0);const N=n.useMemo(()=>({index:l,last:v,expanded:d,icon:l+1,active:h,completed:R,disabled:y}),[l,v,d,h,R,y]),b={...a,active:h,orientation:P,alternativeLabel:w,completed:R,disabled:y,expanded:d,component:i},M=Ie(b),C=t.jsxs(Te,{as:i,className:$(M.root,u),ref:s,ownerState:b,...j,children:[x&&w&&l!==0?x:null,c]});return t.jsx(ie.Provider,{value:N,children:x&&!w&&l!==0?t.jsxs(n.Fragment,{children:[x,C]}):C})}),Ne=me(t.jsx("path",{d:"M12 0a12 12 0 1 0 0 24 12 12 0 0 0 0-24zm-2 17l-5-5 1.4-1.4 3.6 3.6 7.6-7.6L19 8l-9 9z"})),ke=me(t.jsx("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"}));function ze(e){return B("MuiStepIcon",e)}const ae=D("MuiStepIcon",["root","active","completed","error","text"]);var de;const $e=e=>{const{classes:o,active:s,completed:a,error:r}=e;return A({root:["root",s&&"active",a&&"completed",r&&"error"],text:["text"]},ze,o)},re=L(ge,{name:"MuiStepIcon",slot:"Root"})(V(({theme:e})=>({display:"block",transition:e.transitions.create("color",{duration:e.transitions.duration.shortest}),color:(e.vars||e).palette.text.disabled,[`&.${ae.completed}`]:{color:(e.vars||e).palette.primary.main},[`&.${ae.active}`]:{color:(e.vars||e).palette.primary.main},[`&.${ae.error}`]:{color:(e.vars||e).palette.error.main}}))),Ee=L("text",{name:"MuiStepIcon",slot:"Text"})(V(({theme:e})=>({fill:(e.vars||e).palette.primary.contrastText,fontSize:e.typography.caption.fontSize,fontFamily:e.typography.fontFamily}))),Ue=n.forwardRef(function(o,s){const a=W({props:o,name:"MuiStepIcon"}),{active:r=!1,className:c,completed:u=!1,error:i=!1,icon:p,...f}=a,d={...a,active:r,completed:u,error:i},l=$e(d);if(typeof p=="number"||typeof p=="string"){const v=$(c,l.root);return i?t.jsx(re,{as:ke,className:v,ref:s,ownerState:d,...f}):u?t.jsx(re,{as:Ne,className:v,ref:s,ownerState:d,...f}):t.jsxs(re,{className:v,ref:s,ownerState:d,...f,children:[de||(de=t.jsx("circle",{cx:"12",cy:"12",r:"12"})),t.jsx(Ee,{className:l.text,x:"12",y:"12",textAnchor:"middle",dominantBaseline:"central",ownerState:d,children:p})]})}return p});function Fe(e){return B("MuiStepLabel",e)}const O=D("MuiStepLabel",["root","horizontal","vertical","label","active","completed","error","disabled","iconContainer","alternativeLabel","labelContainer"]),Be=e=>{const{classes:o,orientation:s,active:a,completed:r,error:c,disabled:u,alternativeLabel:i}=e;return A({root:["root",s,c&&"error",u&&"disabled",i&&"alternativeLabel"],label:["label",a&&"active",r&&"completed",c&&"error",u&&"disabled",i&&"alternativeLabel"],iconContainer:["iconContainer",a&&"active",r&&"completed",c&&"error",u&&"disabled",i&&"alternativeLabel"],labelContainer:["labelContainer",i&&"alternativeLabel"]},Fe,o)},De=L("span",{name:"MuiStepLabel",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:s}=e;return[o.root,o[s.orientation]]}})({display:"flex",alignItems:"center",[`&.${O.alternativeLabel}`]:{flexDirection:"column"},[`&.${O.disabled}`]:{cursor:"default"},variants:[{props:{orientation:"vertical"},style:{textAlign:"left",padding:"8px 0"}}]}),We=L("span",{name:"MuiStepLabel",slot:"Label"})(V(({theme:e})=>({...e.typography.body2,display:"block",transition:e.transitions.create("color",{duration:e.transitions.duration.shortest}),[`&.${O.active}`]:{color:(e.vars||e).palette.text.primary,fontWeight:500},[`&.${O.completed}`]:{color:(e.vars||e).palette.text.primary,fontWeight:500},[`&.${O.alternativeLabel}`]:{marginTop:16},[`&.${O.error}`]:{color:(e.vars||e).palette.error.main}}))),Ae=L("span",{name:"MuiStepLabel",slot:"IconContainer"})({flexShrink:0,display:"flex",paddingRight:8,[`&.${O.alternativeLabel}`]:{paddingRight:0}}),Ve=L("span",{name:"MuiStepLabel",slot:"LabelContainer"})(V(({theme:e})=>({width:"100%",color:(e.vars||e).palette.text.secondary,[`&.${O.alternativeLabel}`]:{textAlign:"center"}}))),he=n.forwardRef(function(o,s){const a=W({props:o,name:"MuiStepLabel"}),{children:r,className:c,componentsProps:u={},error:i=!1,icon:p,optional:f,slots:d={},slotProps:l={},StepIconComponent:v,StepIconProps:j,...S}=a,{alternativeLabel:x,orientation:w}=n.useContext(J),{active:P,disabled:g,completed:h,icon:R}=n.useContext(ie),y=p||R;let N=v;y&&!N&&(N=Ue);const b={...a,active:P,alternativeLabel:x,completed:h,disabled:g,error:i,orientation:w},M=Be(b),C={slots:d,slotProps:{stepIcon:j,...u,...l}},[Q,q]=Z("root",{elementType:De,externalForwardedProps:{...C,...S},ownerState:b,ref:s,className:$(M.root,c)}),[X,k]=Z("label",{elementType:We,externalForwardedProps:C,ownerState:b}),[H,_]=Z("stepIcon",{elementType:N,externalForwardedProps:C,ownerState:b});return t.jsxs(Q,{...q,children:[y||H?t.jsx(Ae,{className:M.iconContainer,ownerState:b,children:t.jsx(H,{completed:h,active:P,error:i,icon:y,..._})}):null,t.jsxs(Ve,{className:M.labelContainer,ownerState:b,children:[r?t.jsx(X,{...k,className:$(M.label,k==null?void 0:k.className),children:r}):null,f]})]})});he.muiName="StepLabel";function qe(e){return B("MuiStepConnector",e)}D("MuiStepConnector",["root","horizontal","vertical","alternativeLabel","active","completed","disabled","line","lineHorizontal","lineVertical"]);const He=e=>{const{classes:o,orientation:s,alternativeLabel:a,active:r,completed:c,disabled:u}=e,i={root:["root",s,a&&"alternativeLabel",r&&"active",c&&"completed",u&&"disabled"],line:["line",`line${fe(s)}`]};return A(i,qe,o)},_e=L("div",{name:"MuiStepConnector",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:s}=e;return[o.root,o[s.orientation],s.alternativeLabel&&o.alternativeLabel,s.completed&&o.completed]}})({flex:"1 1 auto",variants:[{props:{orientation:"vertical"},style:{marginLeft:12}},{props:{alternativeLabel:!0},style:{position:"absolute",top:12,left:"calc(-50% + 20px)",right:"calc(50% + 20px)"}}]}),Ge=L("span",{name:"MuiStepConnector",slot:"Line",overridesResolver:(e,o)=>{const{ownerState:s}=e;return[o.line,o[`line${fe(s.orientation)}`]]}})(V(({theme:e})=>{const o=e.palette.mode==="light"?e.palette.grey[400]:e.palette.grey[600];return{display:"block",borderColor:e.vars?e.vars.palette.StepConnector.border:o,variants:[{props:{orientation:"horizontal"},style:{borderTopStyle:"solid",borderTopWidth:1}},{props:{orientation:"vertical"},style:{borderLeftStyle:"solid",borderLeftWidth:1,minHeight:24}}]}})),Ye=n.forwardRef(function(o,s){const a=W({props:o,name:"MuiStepConnector"}),{className:r,...c}=a,{alternativeLabel:u,orientation:i="horizontal"}=n.useContext(J),{active:p,disabled:f,completed:d}=n.useContext(ie),l={...a,alternativeLabel:u,orientation:i,active:p,completed:d,disabled:f},v=He(l);return t.jsx(_e,{className:$(v.root,r),ref:s,ownerState:l,...c,children:t.jsx(Ge,{className:v.line,ownerState:l})})});function Ke(e){return B("MuiStepper",e)}D("MuiStepper",["root","horizontal","vertical","nonLinear","alternativeLabel"]);const Je=e=>{const{orientation:o,nonLinear:s,alternativeLabel:a,classes:r}=e;return A({root:["root",o,s&&"nonLinear",a&&"alternativeLabel"]},Ke,r)},Qe=L("div",{name:"MuiStepper",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:s}=e;return[o.root,o[s.orientation],s.alternativeLabel&&o.alternativeLabel,s.nonLinear&&o.nonLinear]}})({display:"flex",variants:[{props:{orientation:"horizontal"},style:{flexDirection:"row",alignItems:"center"}},{props:{orientation:"vertical"},style:{flexDirection:"column"}},{props:{alternativeLabel:!0},style:{alignItems:"flex-start"}}]}),Xe=t.jsx(Ye,{}),Ze=n.forwardRef(function(o,s){const a=W({props:o,name:"MuiStepper"}),{activeStep:r=0,alternativeLabel:c=!1,children:u,className:i,component:p="div",connector:f=Xe,nonLinear:d=!1,orientation:l="horizontal",...v}=a,j={...a,nonLinear:d,alternativeLabel:c,orientation:l,component:p},S=Je(j),x=n.Children.toArray(u).filter(Boolean),w=x.map((g,h)=>n.cloneElement(g,{index:h,last:h+1===x.length,...g.props})),P=n.useMemo(()=>({activeStep:r,alternativeLabel:c,connector:f,nonLinear:d,orientation:l}),[r,c,f,d,l]);return t.jsx(J.Provider,{value:P,children:t.jsx(Qe,{as:p,ownerState:j,className:$(S.root,i),ref:s,...v,children:w})})});let ue=!1;const et=()=>{ue||(console.warn(["MUI: The LoadingButton component functionality is now part of the Button component from Material UI.","","You should use `import Button from '@mui/material/Button'`","or `import { Button } from '@mui/material'`"].join(`
`)),ue=!0)},ne=n.forwardRef(function(o,s){return et(),t.jsx(K,{ref:s,...o})});function tt(){const e=ye(),[o,s]=n.useState(""),[a,r]=n.useState(!1),[c,u]=n.useState(!1),[i,p]=n.useState(0),[f,d]=n.useState(""),[l,v]=n.useState(!1),[j,S]=n.useState(!1),x=te({defaultValues:{email:"",password:""}}),w=ce({email:F().email("Please enter a valid email address")}),P=ce({email:F().email("Please enter a valid email address"),otp:F().min(6,"OTP must be 6 digits").max(6,"OTP must be 6 digits"),newPassword:F().min(8,"Password must be at least 8 characters"),confirmPassword:F()}).refine(m=>m.newPassword===m.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]}),g=te({resolver:pe(w),defaultValues:{email:""}}),h=te({resolver:pe(P),defaultValues:{email:"",otp:"",newPassword:"",confirmPassword:""}}),{handleSubmit:R,reset:y}=x,{handleSubmit:N,reset:b}=g,{handleSubmit:M,reset:C,formState:{errors:Q}}=h,q=n.useCallback(async()=>{try{(await G.get(Y.auth.check_auth)).status===200&&e.push("/dashboard")}catch(m){console.error("Auth check failed",m)}},[e]);n.useEffect(()=>{q()},[q]);const{checkUserSession:X}=Le(),k=R(async m=>{var I,E;s(""),r(!0);try{const T=await G.post(Y.auth.signIn,{email:m.email,password:m.password});y(),T.status===200&&(await X(),e.push("/dashboard"))}catch(T){console.error("Login error:",T),s(((E=(I=T.response)==null?void 0:I.data)==null?void 0:E.message)||"Login failed")}finally{r(!1)}}),H=()=>{u(!0),p(0),b(),C()},_=()=>{u(!1),p(0),b(),C()},xe=N(async m=>{v(!0);try{(await G.post(Y.auth.requestOtp,{email:m.email})).status===200&&(d(m.email),p(1),console.log("OTP sent successfully. Check console for OTP code."))}catch(I){console.error("OTP request error:",I),d(m.email),p(1),console.log("OTP sent successfully. Check console for OTP code.")}finally{v(!1)}}),be=M(async m=>{var I,E;S(!0);try{(await G.post(Y.auth.verifyOtp,{email:f,otp:m.otp,newPassword:m.newPassword})).status===200&&p(2)}catch(T){console.error("OTP verification error:",T),s(((E=(I=T.response)==null?void 0:I.data)==null?void 0:E.message)||"Invalid OTP or password reset failed")}finally{S(!1)}}),Se=["Enter Email","Verify OTP","Success"];return t.jsxs(t.Fragment,{children:[t.jsxs(ee,{variant:"h4",gutterBottom:!0,children:["Sign in to ",ve.appName]}),t.jsx(U,{severity:"info",sx:{mb:3},children:"Use your registered email and password to sign in."}),o&&t.jsx(U,{severity:"error",sx:{mb:3},children:o}),t.jsxs(oe,{methods:x,onSubmit:k,children:[t.jsxs(se,{spacing:3,children:[t.jsx(z,{name:"email",label:"Email address"}),t.jsx(z,{name:"password",label:"Password",type:"password"})]}),t.jsx(ne,{fullWidth:!0,size:"large",type:"submit",variant:"contained",loading:a,sx:{mt:3},children:"Sign in"}),t.jsx(K,{fullWidth:!0,variant:"text",onClick:H,sx:{mt:1},children:"Forgot Password?"}),t.jsx(K,{fullWidth:!0,variant:"text",component:Ce,href:we.auth.cookie.signUp,sx:{mt:1},children:"Don't have an account? Sign up"})]}),t.jsxs(je,{open:c,onClose:_,maxWidth:"sm",fullWidth:!0,children:[t.jsx(Pe,{children:"Reset Password"}),t.jsx(Re,{children:t.jsxs(le,{sx:{mt:2},children:[t.jsx(Ze,{activeStep:i,sx:{mb:3},children:Se.map(m=>t.jsx(Oe,{children:t.jsx(he,{children:m})},m))}),i===0&&t.jsx(oe,{methods:g,onSubmit:xe,children:t.jsxs(se,{spacing:3,children:[t.jsx(ee,{variant:"body2",color:"text.secondary",children:"Enter your email address to receive a one-time password (OTP)."}),t.jsx(z,{name:"email",label:"Email address",type:"email",required:!0}),t.jsx(ne,{fullWidth:!0,type:"submit",variant:"contained",loading:l,children:"Send OTP"})]})}),i===1&&t.jsx(oe,{methods:h,onSubmit:be,children:t.jsxs(se,{spacing:3,children:[t.jsxs(ee,{variant:"body2",color:"text.secondary",children:["Enter the OTP sent to ",f," and your new password."]}),t.jsx(U,{severity:"info",children:"Check the console for the OTP code (for development purposes)."}),t.jsx(z,{name:"otp",label:"OTP Code",required:!0,inputProps:{maxLength:6}}),t.jsx(z,{name:"newPassword",label:"New Password",type:"password",required:!0}),t.jsx(z,{name:"confirmPassword",label:"Confirm New Password",type:"password",required:!0}),Q.confirmPassword&&t.jsx(U,{severity:"error",children:"Passwords do not match"}),t.jsx(ne,{fullWidth:!0,type:"submit",variant:"contained",loading:j,children:"Reset Password"})]})}),i===2&&t.jsxs(le,{sx:{textAlign:"center",py:2},children:[t.jsx(U,{severity:"success",sx:{mb:2},children:"Password reset successful! You can now sign in with your new password."}),t.jsx(K,{variant:"contained",onClick:_,children:"Close"})]})]})})]})]})}const ot={title:`Sign in | Cookie - ${ve.appName}`};function pt(){return t.jsxs(t.Fragment,{children:[t.jsx("title",{children:ot.title}),t.jsx(tt,{})]})}export{pt as default};
