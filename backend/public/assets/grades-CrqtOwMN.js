import{z as P,E as _,r as u,G as f,W as D,j as e,e as W,w as C,p as y,k as d,T as n,ad as Y,aa as E,B as k,aN as z}from"./index-B2Cbre3s.js";import{C as M}from"./custom-breadcrumbs-CnqUOG1T.js";import{G as c}from"./Grid-BRF5KrpT.js";import{T as $}from"./TableContainer-DTSdEQoF.js";import{b as H,d as q,T as A,a as l,c as J}from"./TableHead-CEhwUuF5.js";const v={title:`My Grades | Student Dashboard - ${W.appName}`};function te(){const w=P(),{authenticated:h,user:o}=_(),[i,T]=u.useState([]),[G,p]=u.useState(!0),g=u.useCallback(async()=>{if(o!=null&&o.UID)try{p(!0);const s=(await f.get(D.courses.list)).data.courses||[],r=[];for(const a of s)try{const b=((await f.get(D.courses.students(a.COURSEID))).data.students||[]).find(U=>U.UID===o.UID);b&&r.push({...a,enrollment:b})}catch(x){console.error(`Error fetching enrollment for course ${a.COURSEID}:`,x)}T(r)}catch(t){console.error("Error fetching enrolled courses:",t)}finally{p(!1)}},[o==null?void 0:o.UID]);if(u.useEffect(()=>{h&&(o!=null&&o.UID)&&g()},[h,o==null?void 0:o.UID,g]),!h)return w.push("/login"),null;const R=t=>{const s=new Date,r=new Date(t.STARTDATE),a=new Date(t.ENDDATE);return r>s?{label:"Upcoming",color:"info"}:r<=s&&a>=s?{label:"Ongoing",color:"success"}:{label:"Completed",color:"default"}},S=t=>t?t>=90?"success":t>=80?"primary":t>=70?"warning":"error":"default",I=t=>t?t>=90?"A":t>=80?"B":t>=70?"C":t>=60?"D":"F":"N/A",j=t=>new Date(t).toLocaleDateString(),N=()=>{const t=i.filter(r=>r.enrollment.FINAL_GRADE);return t.length===0?0:(t.reduce((r,a)=>r+a.enrollment.FINAL_GRADE,0)/t.length).toFixed(2)},L=()=>i.filter(t=>new Date(t.ENDDATE)<new Date),B=()=>i.filter(t=>{const s=new Date,r=new Date(t.STARTDATE),a=new Date(t.ENDDATE);return r<=s&&a>=s});if(G)return e.jsxs(e.Fragment,{children:[e.jsx("title",{children:v.title}),e.jsx(C,{maxWidth:"xl",children:e.jsx("div",{children:"Loading your grades..."})})]});const O=N(),m=L(),F=B();return e.jsxs(e.Fragment,{children:[e.jsx("title",{children:v.title}),e.jsxs(C,{maxWidth:"xl",children:[e.jsx(M,{heading:"My Grades",links:[{name:"Dashboard",href:y.dashboard.root},{name:"Student",href:y.dashboard.student.courses},{name:"My Grades"}],sx:{mb:{xs:3,md:5}}}),i.length===0?e.jsxs(d,{sx:{p:4,textAlign:"center"},children:[e.jsx(n,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"You are not enrolled in any courses yet."}),e.jsx(n,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Contact an administrator to enroll you in courses."})]}):e.jsxs(c,{container:!0,spacing:3,children:[e.jsx(c,{item:!0,xs:12,md:4,children:e.jsxs(d,{sx:{p:3,textAlign:"center",border:"1px solid #e0e0e0",borderRadius:2,boxShadow:"0 4px 12px rgba(0,0,0,0.1)",transition:"all 0.3s ease","&:hover":{boxShadow:"0 8px 24px rgba(0,0,0,0.15)",transform:"translateY(-4px)",borderColor:"primary.main"}},children:[e.jsx(n,{variant:"h4",color:"primary",gutterBottom:!0,children:O}),e.jsx(n,{variant:"h6",gutterBottom:!0,children:"GPA"}),e.jsxs(n,{variant:"body2",color:"text.secondary",children:[m.length," completed courses"]})]})}),e.jsx(c,{item:!0,xs:12,md:4,children:e.jsxs(d,{sx:{p:3,textAlign:"center",border:"1px solid #e0e0e0",borderRadius:2,boxShadow:"0 4px 12px rgba(0,0,0,0.1)",transition:"all 0.3s ease","&:hover":{boxShadow:"0 8px 24px rgba(0,0,0,0.15)",transform:"translateY(-4px)",borderColor:"success.main"}},children:[e.jsx(n,{variant:"h4",color:"success.main",gutterBottom:!0,children:m.length}),e.jsx(n,{variant:"h6",gutterBottom:!0,children:"Completed Courses"}),e.jsxs(n,{variant:"body2",color:"text.secondary",children:[m.filter(t=>t.enrollment.FINAL_GRADE).length," with grades"]})]})}),e.jsx(c,{item:!0,xs:12,md:4,children:e.jsxs(d,{sx:{p:3,textAlign:"center",border:"1px solid #e0e0e0",borderRadius:2,boxShadow:"0 4px 12px rgba(0,0,0,0.1)",transition:"all 0.3s ease","&:hover":{boxShadow:"0 8px 24px rgba(0,0,0,0.15)",transform:"translateY(-4px)",borderColor:"info.main"}},children:[e.jsx(n,{variant:"h4",color:"info.main",gutterBottom:!0,children:F.length}),e.jsx(n,{variant:"h6",gutterBottom:!0,children:"Ongoing Courses"}),e.jsx(n,{variant:"body2",color:"text.secondary",children:"Currently enrolled"})]})}),e.jsx(c,{item:!0,xs:12,children:e.jsxs(d,{sx:{p:3},children:[e.jsx(n,{variant:"h6",gutterBottom:!0,children:"Course Grades"}),e.jsx($,{component:Y,variant:"outlined",children:e.jsxs(H,{children:[e.jsx(q,{children:e.jsxs(A,{children:[e.jsx(l,{children:"Course"}),e.jsx(l,{children:"Status"}),e.jsx(l,{children:"Final Grade"}),e.jsx(l,{children:"Letter Grade"}),e.jsx(l,{children:"Enrollment Date"}),e.jsx(l,{children:"Completion Date"})]})}),e.jsx(J,{children:i.map(t=>{const s=R(t),r=t.enrollment.FINAL_GRADE,a=S(r),x=I(r);return e.jsxs(A,{children:[e.jsxs(l,{children:[e.jsx(n,{variant:"subtitle2",children:t.TITLE}),e.jsx(n,{variant:"body2",color:"text.secondary",children:t.LOCATION})]}),e.jsx(l,{children:e.jsx(E,{label:s.label,color:s.color,size:"small"})}),e.jsx(l,{children:r?e.jsxs(k,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsxs(n,{variant:"body2",children:[r,"%"]}),e.jsx(z,{variant:"determinate",value:r,color:a,sx:{width:60,height:6,borderRadius:3}})]}):e.jsx(n,{variant:"body2",color:"text.secondary",children:"Pending"})}),e.jsx(l,{children:r?e.jsx(E,{label:x,color:a,size:"small"}):e.jsx(n,{variant:"body2",color:"text.secondary",children:"N/A"})}),e.jsx(l,{children:j(t.enrollment.ENROLL_DATE)}),e.jsx(l,{children:s.label==="Completed"?j(t.ENDDATE):"Ongoing"})]},t.COURSEID)})})]})})]})})]})]})]})}export{te as default};
