import{r as o,j as e,d as k,u as I,f as m,h as p,i as h,T as A,e as w,A as g}from"./index-BvmmVfrz.js";import"./jwt-sign-up-view-DfZdZSlg.js";import{u as E,F as R,R as f}from"./form-provider-G3Bra4Rg.js";import{S as v}from"./Stack-Cb8U67Ez.js";import"./isMuiElement-f-GUJh5x.js";let x=!1;const C=()=>{x||(console.warn(["MUI: The LoadingButton component functionality is now part of the Button component from Material UI.","","You should use `import Button from '@mui/material/Button'`","or `import { Button } from '@mui/material'`"].join(`
`)),x=!0)},M=o.forwardRef(function(n,r){return C(),e.jsx(k,{ref:r,...n})});function T(){const a=I(),[n,r]=o.useState(""),[j,i]=o.useState(!1),c=E({defaultValues:{email:"",password:""}}),{handleSubmit:y,reset:S}=c,{authenticated:B,user:L}=m();console.log("Current auth state:",{authenticated:B,user:L});const u=o.useCallback(async()=>{try{const t=await p.get(h.auth.check_auth);console.log("Auth check response:",t.data),t.status===200&&a.push("/profile")}catch(t){console.error("Auth check failed",t)}},[a]);o.useEffect(()=>{u()},[u]);const{checkUserSession:b}=m(),F=y(async t=>{var l,d;r(""),i(!0);try{const s=await p.post(h.auth.signIn,{email:t.email,password:t.password});console.log("Login successful:",s.data.message),S(),s.status===200&&(console.log("Login successful, updating auth context..."),await b(),a.push("/profile"))}catch(s){console.error("Login error:",s),r(((d=(l=s.response)==null?void 0:l.data)==null?void 0:d.message)||"Login failed")}finally{i(!1)}});return e.jsxs(e.Fragment,{children:[e.jsxs(A,{variant:"h4",gutterBottom:!0,children:["Sign in to ",w.appName]}),e.jsx(g,{severity:"info",sx:{mb:3},children:"Use your registered email and password to sign in."}),n&&e.jsx(g,{severity:"error",sx:{mb:3},children:n}),e.jsxs(R,{methods:c,onSubmit:F,children:[e.jsxs(v,{spacing:3,children:[e.jsx(f,{name:"email",label:"Email address"}),e.jsx(f,{name:"password",label:"Password",type:"password"})]}),e.jsx(M,{fullWidth:!0,size:"large",type:"submit",variant:"contained",loading:j,sx:{mt:3},children:"Sign in"})]})]})}const U={title:`Sign in | Jwt - ${w.appName}`};function z(){return e.jsxs(e.Fragment,{children:[e.jsx("title",{children:U.title}),e.jsx(T,{})]})}export{z as default};
